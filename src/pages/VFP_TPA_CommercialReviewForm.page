<apex:page language="{!language}" controller="CNT_TPA_CommercialReviewForm"  action="{!requestValidateOnLoad}" showHeader="false" sidebar="false" cache="false" id="pg" lightningStylesheets="true" standardStylesheets="false"> 
    <apex:slds />
    <!-- Added for site to community logic submission start -->
    <script type="text/javascript">
        console.log('currentLoggedInUserProfile0 in VFP_TPA_CommercialReviewForm::::'+'{!currentUserProfileName}');
        function getUrlVars() {
        var vars = {}, hash;
        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
        for(var i = 0; i < hashes.length; i++) {
            hash = hashes[i].split('=');
            vars[hash[0]] = hash[1];
        }
        return vars;
		}
        //console.log('currentLoggedInUserProfile::::'+'{!currentUserProfileName}');
        if('{!currentUserProfileName}' == 'tpa Profile') {
            var qryString = '';
            var urlParams = getUrlVars();
            for(var key in urlParams) {
                if(urlParams.hasOwnProperty(key)) {
                    var val = urlParams[key];
                    qryString += key + '=' + val + '&';
                }
            }
            console.log('quryString-1:::'+JSON.stringify(urlParams));
            console.log('quryString:::'+qryString);
            qryString = qryString.slice(0, -1);
            console.log('quryString0:::'+qryString);
            console.log('quryString1:::'+'{!tpaCommunityUrl}');
            window.location.href = '{!tpaCommunityUrl}' + '/VFP_TPA_ExternalUserAction?actionType=tpasitelinkaccess&returlpage=VFP_TPA_CommercialReviewForm&' + qryString;
        }
    </script>
    <apex:outputPanel rendered="{!IF(currentUserProfileName != 'tpa Profile',True, False)}">
    <!-- Added for site to community logic submission end-->  
        <html>
            <head>
                <meta http-equiv="X-UA-Compatible" content="IE=9" />
                <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

                <!-- *** Angular-JS Library reference ** -->
                <apex:includeScript value="{!$Resource.AngularJS}"/>
                <!-- *** Angular-JS Library reference ** -->

                <!-- *** Angular-JS Bootstrap Modal Pop Up Library reference ** -->
                <script src="{!$Resource.AngularUiBootstrap}" type="text/javascript"></script>
                <!-- *** Angular-JS Bootstrap Modal Pop Up Library reference ** -->

                <!-- *** Jquery library reference *** -->
                <script src="{!$Resource.TPAJquery}" type="text/javascript"></script>
                <!-- *** Jquery library reference *** -->

                <script src="{!$Resource.TpaJQueryCookie}" type="text/javascript"></script>

                <!-- *** JQuery UI Library reference *** -->
                <script src="{!$Resource.TPAJqueryUI}" type="text/javascript"></script>
                <!-- *** JQuery UI Library reference *** -->

                <!-- *** JQuery Custom Popup Library reference *** -->
                <script src="{!URLFOR($Resource.TpaCustomPopup, 'popup.js')}" type="text/javascript"></script>
                <!-- *** JQuery Custom Popup Library reference *** -->

                <!-- *** JQuery Custom Popup Stylesheet reference *** -->
                <link href="{!URLFOR($Resource.TpaCustomPopup, 'popup.css')}" rel="stylesheet" type="text/css"/>
                <!-- *** JQuery Custom Popup Stylesheet reference *** -->
                
                <link href="{!URLFOR($Resource.TPAJqueryUICss)}" rel="stylesheet" type="text/css" />  <!-- *** JQuery UI Stylesheet reference *** -->

                <!-- *** Bootstrap Javascript Library reference *** -->
                <script src="{!$Resource.BootstrapJS}" type="text/javascript"></script>
                <!-- *** Bootstrap Javascript Library reference *** -->

                <link href="{!$Resource.TPA_Multilingual_CSS}" rel="stylesheet" type="text/css" />

                <!-- ****** AngularJS script Start ****** -->
                <style>
                    #reqNo::-webkit-input-placeholder { color: #13D7E1;  }
                    #reqNo:-moz-placeholder { /* Firefox 18- */
                    color: #13D7E1;
                    }
                    #reqNo::-moz-placeholder {  /* Firefox 19+ */
                    color: #13D7E1;
                    }
                    #reqNo:-ms-input-placeholder {
                    color: #13D7E1;
                    }
                </style>

                <!-- ****** AngularJS script Start ****** -->
                <script type="text/javascript">
                    <!-- Angular JS Application Name -->
                    var myapp = angular.module('TpaAccessRequest', ['ui.bootstrap']);

                    <!-- Page Controller Start -->
                    myapp.filter('myLimitTo', function() {
                        return function(input, limit, begin) {
                            console.log('begin'+begin);
                            return input.slice(begin, input.length < (begin + limit) ? input.length : begin + limit);
                        };
                    });
                    var contrl = myapp.controller('controllerPage',['$scope', '$filter', '$modal', '$log', '$window', function ($scope, $filter, $modal, $log, $window)
                    {
                        <!-- Initialize Services -->
                        $scope.$log = $log;
                        <!-- Initialize Services -->

                        <!-- Initialize Model Variables -->
                        //****** tpa request models start ******//
                        $scope.tpaObj = {};
                        $scope.tpaObj.clientProjectName = '';
                        $scope.tpaObj.clientName = '';


                        $scope.vendorActionList = [];
                        $scope.vendorActionListForSecReview = [];
                        $scope.vendorOtherActionList = [];
                        $scope.tpOtherReasonAvailable = false;
                        $scope.tpOtherReasonNotAvailable = false;
                        $scope.otherReasonAvailable = false;
                        $scope.renewOptionName = '';
                        $scope.commercialOwnerName = '';
                        $scope.dateOfReview = '';
                        $scope.nameLabel = 'Commercial Owner Name:' ;

                        $scope.tpaRequest = [];
                        $scope.tpaReqId = '{!tpaRequestId}';
                        $scope.SelectedComReviewList = {!commercialListToShow};
                        $scope.legalEntityListforOther = JSON.parse('{!LegalEntityList}');

                        $scope.totalNoOfRecs = {!countOfRecords};
                        $scope.isTPProcessorLogin = {!isTPProcessorLogin};
                        $scope.latestAMAContractDate = '{!latestAMAContractDate}'
                        
                        $scope.objTpaRequestToEdit = {};
                        $scope.allObjects = [];

                        const d = new Date();
                        $scope.SelectedComReviewMap;
                        $scope.SelectedComReviewMap2 = [];
                        $scope.SelectedComReviewListArray = [];
                        $scope.tpProAddTermReviews = [];
                        $scope.tpProAddTermAction = [];
                        $scope.setComReviewToUpdate = [];
                        $scope.TextEditorList;
                        $scope.FilterTextEditorList;
                        $scope.TextEditorReason = '';
                        $scope.viewMode = '';
                        $scope.comEmailID = '';
                        $scope.employeeStoreDataCountry = '{!employeeStoreDataCountry}';
                        $scope.employeeAccessDataCountry = '{!employeeAccessDataCountry}';
                        $scope.vendorLegalName = '{!vendorLegalName}';
                        $scope.$log.info('$scope.employeeStoreDataCountry'+$scope.employeeStoreDataCountry);
                        $scope.$log.info('$scope.employeeAccessDataCountry'+$scope.employeeAccessDataCountry);
                        $scope.vendorchecklist = false;
                        $scope.newvendorchecklist = false;
                        $scope.vendorpharmachecklist = false;
                        $scope.vendorlegalfirmchecklist = false;
                        $scope.vendoracademiachecklist = false;
                        $scope.selLegalEntity = 'Select Other - Offering IQVIA Legal Entity Here';
                        $scope.$log.info('$scope.todayDate'+d);
                        const month = d.getUTCMonth() + 1;
                        $scope.dateOfReview = d.getUTCFullYear() + '-' + month + '-' + d.getUTCDate();
                        $scope.$log.info('$scope.dateOfReviewbefore'+$scope.dateOfReview);
                        $scope.lstDateSplitted3= [];
                        if($scope.dateOfReview != null) {
                            $scope.lstDateSplitted3 = $scope.dateOfReview.split('-');
                            if($scope.lstDateSplitted3[1].length == 1){
                                $scope.lstDateSplitted3[1] = '0'+$scope.lstDateSplitted3[1];
                            }
                            if($scope.lstDateSplitted3[2].length == 1){
                                $scope.lstDateSplitted3[2] = '0'+$scope.lstDateSplitted3[2];
                            }
                            $scope.dateOfReview = $scope.lstDateSplitted3[1]+'/'+$scope.lstDateSplitted3[2]+'/'+$scope.lstDateSplitted3[0];
                        }
                        $scope.$log.info('$scope.dateOfReviewafter'+$scope.dateOfReview);

                        //*** Error Flags ***//
                        $scope.isError = false;
                        $scope.isCommercialOwnerNameError = false;
                        $scope.isCommercialReasonActionTakenError = false;
                        $scope.manualreasonSummaryPopup = false;
                        $scope.isSortingAllowed = true;
                        $scope.columnSortBy = 'reason';
                        $scope.isDescending = false;
                        $scope.sortOrder = 'ascReason';
                        $scope.descImage = '&nbsp;<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAA3NCSVQICAjb4U/gAAAAD1BMVEX////////e3t6ZmZkzMzPjUSqdAAAABXRSTlMA/////xzQJlIAAAAJcEhZcwAACvAAAArwAUKsNJgAAAAldEVYdFNvZnR3YXJlAE1hY3JvbWVkaWEgRmlyZXdvcmtzIE1YIDIwMDSHdqzPAAAAKklEQVR4nGNgIA+wuACBA4hhJCioDGIwOCsKmUDkjCACQCETmHIHIs0FABo8BA7kFkjvAAAAAElFTkSuQmCC" alt="test Image" />';
                        $scope.ascImage = '&nbsp;<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAA3NCSVQICAjb4U/gAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAPUExURf///////97e3pmZmTMzM+NRKp0AAAABdFJOUwBA5thmAAAACXBIWXMAAArwAAAK8AFCrDSYAAAAJXRFWHRTb2Z0d2FyZQBNYWNyb21lZGlhIEZpcmV3b3JrcyBNWCAyMDA0h3aszwAAAClJREFUGNNjIBKwOEAZziZQASNliJCzopAJREBQECzE4gIEDgzkAAYGACuRBA6ce+7fAAAAAElFTkSuQmCC" alt="test Image" />';
                        
                        $scope.validateForm = function()
                        {
                            $scope.errorMsg = '';
                            $scope.$log.info('viewMode123'+$scope.viewMode);
                            if($scope.tpProAddTermReviews != null){
                                for(var i = 0;i<$scope.tpProAddTermReviews.length;i++){
                                    var value = $scope.tpProAddTermReviews[i];
                                    if((value.action != '' || value.action != null) && value.action == 'Confirmed - Include in Renewal' && value.addTermUpdated){
                                        if(!$scope.errorMsg.includes('<li>This Ad-hoc Additional Term was edited/changed. The selection is not valid for this term. For any questions/uncertainty on how to do this, please reach out to TP-US@iqvia.com (EST U.S. hours) or IQVIAThirdPartyAccessProgram@iqvia.com (Outside U.S. EST hours).</li>')){
                                            $scope.errorMsg += '<li>This Ad-hoc Additional Term was edited/changed. The selection is not valid for this term. For any questions/uncertainty on how to do this, please reach out to TP-US@iqvia.com (EST U.S. hours) or IQVIAThirdPartyAccessProgram@iqvia.com (Outside U.S. EST hours).</li>';
                                        }
                                    }
                                    else if((value.action != '' || value.action != null) && value.action == 'Confirmed - Include Updated Additional Term in Renewal' && !value.addTermUpdated ){
                                        if(!$scope.errorMsg.includes('<li>This Ad-hoc Additional Term was not edited/changed. You must edit the Ad-hoc Additional Term on the TPA Request Record before you can make this selection. For any questions/uncertainty on how to do this, please reach out to TP-US@iqvia.com (EST U.S. hours) or IQVIAThirdPartyAccessProgram@iqvia.com (Outside U.S. EST hours).</li>')){
                                            $scope.errorMsg += '<li>This Ad-hoc Additional Term was not edited/changed. You must edit the Ad-hoc Additional Term on the TPA Request Record before you can make this selection. For any questions/uncertainty on how to do this, please reach out to TP-US@iqvia.com (EST U.S. hours) or IQVIAThirdPartyAccessProgram@iqvia.com (Outside U.S. EST hours).</li>';
                                        }
                                    }

                                    if(value.action == 'Under Validation' && value.actionvalue4 == ''){
                                        value.isUnderValidationTextError = true;
                                    }
                                    else
                                        value.isUnderValidationTextError = false;
                                    if(value.isUnderValidationTextError == true && !$scope.errorMsg.includes('<li>Please provide details for each response line where you selected ‘Under Validation’</li>')){
                                        $scope.errorMsg += '<li>Please provide details for each response line where you selected ‘Under Validation’</li>';
                                    }
                                }
                            }
                            if($scope.SelectedComReviewListArray != null) {
                                $scope.$log.info('inside block');
                                for(var i=0; i<$scope.SelectedComReviewListArray.length ; i++) {
                                    if($scope.SelectedComReviewListArray[i].action == 'Questions / Comments' && $scope.SelectedComReviewListArray[i].actionvalue == ''){
                                        $scope.SelectedComReviewListArray[i].isQuestionsCommentsError = true;
                                    }
                                    else
                                		$scope.SelectedComReviewListArray[i].isQuestionsCommentsError = false;
                                    if($scope.SelectedComReviewListArray[i].action == 'Potential Denial - Request TP Processor to arrange meeting with IQVIA Legal' && $scope.SelectedComReviewListArray[i].actionvalue3 == ''){
                                        $scope.SelectedComReviewListArray[i].isPotentialDenialTextError = true;
                                    }
                                    else
                                		$scope.SelectedComReviewListArray[i].isPotentialDenialTextError = false;
                                    if($scope.SelectedComReviewListArray[i].isQuestionsCommentsError == true || $scope.SelectedComReviewListArray[i].isPotentialDenialTextError == true) {
                                        if(!$scope.errorMsg.includes('<li>Please provide details for each response line where you selected ‘Questions/Comments’ and/or ‘Potential Denial’</li>')){
                                            $scope.errorMsg += '<li>Please provide details for each response line where you selected ‘Questions/Comments’ and/or ‘Potential Denial’</li>';
                                        }
                                    }
                                    if($scope.SelectedComReviewListArray[i].action == 'Under Validation' && $scope.SelectedComReviewListArray[i].actionvalue4 == ''){
                                        $scope.SelectedComReviewListArray[i].isUnderValidationTextError = true;
                                    }
                                    else
                                		$scope.SelectedComReviewListArray[i].isUnderValidationTextError = false;
                                    if($scope.SelectedComReviewListArray[i].isUnderValidationTextError == true && !$scope.errorMsg.includes('<li>Please provide details for each response line where you selected ‘Under Validation’</li>')){
                                        $scope.errorMsg += '<li>Please provide details for each response line where you selected ‘Under Validation’</li>';
                                    }
                                    if($scope.SelectedComReviewListArray[i].action == 'Assigned to Commercial Owner (CO) – Awaiting CO Review' && ($scope.SelectedComReviewListArray[i].reason == 'Other Offering Selected' || $scope.SelectedComReviewListArray[i].reason == 'Other Use Selected') && ($scope.viewMode.indexOf('TPSubmit') != -1 || $scope.viewMode == 'TPSubmit') 
                                      && ($scope.SelectedComReviewListArray[i].actionvalue2 == '' || ($scope.SelectedComReviewListArray[i].actionvalue2 != '' && !$scope.isValidEmail($scope.SelectedComReviewListArray[i].actionvalue2)) 
                                         || ($scope.SelectedComReviewListArray[i].offering != '' && $scope.SelectedComReviewListArray[i].offering.indexOf('Other') > -1 && !$scope.SelectedComReviewListArray[i].legalEntityPresent))){
                                        if($scope.SelectedComReviewListArray[i].actionvalue2 == ''){
                                            $scope.SelectedComReviewListArray[i].isResolvedEmailError = true;
                                            if(!$scope.errorMsg.includes('<li>You have selected ‘Assigned to Commercial Owner (CO) – Awaiting CO Review’ – you must add the email address of the Commercial Owner for their commercial review to move this forward in the process.</li>')){
                                                $scope.errorMsg += '<li>You have selected ‘Assigned to Commercial Owner (CO) – Awaiting CO Review’ – you must add the email address of the Commercial Owner for their commercial review to move this forward in the process.</li>';
                                            }
                                        }
                                        else if($scope.SelectedComReviewListArray[i].actionvalue2 != '' && !$scope.isValidEmail($scope.SelectedComReviewListArray[i].actionvalue2)){
                                            $scope.SelectedComReviewListArray[i].isResolvedEmailError = true;
                                            if(!$scope.errorMsg.includes('<li>You have entered an invalid Commercial Owner email address</li>')){
                                                $scope.errorMsg += '<li>You have entered an invalid Commercial Owner email address</li>';
                                            }
                                        }
                                        // else if($scope.SelectedComReviewListArray[i].reason == 'Other Offering Selected' && $scope.SelectedComReviewListArray[i].offering != '' && $scope.SelectedComReviewListArray[i].offering.indexOf('Other') > -1 &&  !$scope.SelectedComReviewListArray[i].legalEntityPresent){
                                        //     $scope.SelectedComReviewListArray[i].isResolvedEmailError = true;
                                        //     if(!$scope.errorMsg.includes('<li>{!$Label.TPA_Other_Offering_selected_please_map_the_Legal_Entity_for_Other_Offering}</li>')){
                                        //         $scope.errorMsg += '<li>{!$Label.TPA_Other_Offering_selected_please_map_the_Legal_Entity_for_Other_Offering}</li>';
                                        //     }
                                        // }
                                        
                                    }
                                    else
                                		$scope.SelectedComReviewListArray[i].isResolvedEmailError = false;

                                    if($scope.SelectedComReviewListArray[i].action != '--None--' && $scope.SelectedComReviewListArray[i].action != 'Questions / Comments' && $scope.SelectedComReviewListArray[i].action != 'Potential Denial - Request TP Processor to arrange meeting with IQVIA Legal' && $scope.SelectedComReviewListArray[i].reason == 'Other Offering Selected' && ($scope.SelectedComReviewListArray[i].selLegalEntity == null || $scope.SelectedComReviewListArray[i].selLegalEntity == '' || $scope.SelectedComReviewListArray[i].selLegalEntity == 'Select Other - Offering IQVIA Legal Entity Here') && $scope.viewMode.indexOf('CSubmit') != -1 && !$scope.SelectedComReviewListArray[i].legalEntityPresent){
                                        //$scope.SelectedComReviewListArray[i].isResolvedEmailError = true;
                                        if(!$scope.errorMsg.includes('<li>Please Select The Legal Entity</li>')){
                                                $scope.errorMsg += '<li>Please Select The Legal Entity</li>';
                                        }
                                    }    
                                }
                            }
                            if(($scope.viewMode.indexOf('CSubmit') != -1 || $scope.viewMode.indexOf('LGL') != -1 ) && ($scope.commercialOwnerName == null || $scope.commercialOwnerName.trim().length == 0))
                            {
                                if($scope.viewMode.indexOf('CSubmit') != -1){
                                    $scope.errorMsg += '<li>Please Enter Commercial Owner Name</li>';
                                }else{
                                    $scope.errorMsg += '<li>Please Enter Legal Reviewer Name</li>';
                                }
                                $scope.isCommercialOwnerNameError = true;
                            }
                            else
                                $scope.isCommercialOwnerNameError = false;


                            if($scope.errorMsg.trim().length > 0)
                            {
                                $scope.isError = true;
                                $scope.errorMsg = '<ul>' + $scope.errorMsg + '</ul>';
                                window.scrollTo(0,0);
                            }
                            else
                            {
                                $scope.errorMsg = '';
                                $scope.isError = false;
                            }
                            $scope.applyChanges();
                            return $scope.isError;
                        }

                        //****** tpa request events start ******//

                        //$scope.amaAgreementDetails = {!amaAgreementDetail};
                        $scope.isSubmitButtonEnabled = {!isSubmitButtonEnabled};
                        $scope.extensionRecCommercialReason = {!extensionRecCommercialReason};
                        $scope.isvalidVendorAccessCountry = {!isvalidVendorAccessCountry};
						$scope.isPreAppTech = {!isPreAppTech};
						$scope.isvalidVendorStorageCountry = {!isvalidVendorStorageCountry};
                        $scope.isvalidClientStorageCountry = {!isvalidClientStorageCountry};
                        $scope.$log.info('isvalidVendorAccessCountry'+$scope.isvalidVendorAccessCountry);
                        $scope.$log.info('isPreAppTech'+$scope.isPreAppTech);
                        $scope.$log.info('isvalidVendorStorageCountry'+$scope.isvalidVendorStorageCountry);
                        $scope.$log.info('isvalidClientStorageCountry'+$scope.isvalidClientStorageCountry);
                        $scope.allDataFetched = false;
                        $scope.currentDataFetched = {};


                        $scope.pageSize = {!pageSize};
                        $scope.currentPageNo = 1;
                        $scope.currentRange =  '1 - 1000' ;
                        $scope.currentIndex = 0;
                        $scope.fetchedTill = 1;
                        $scope.lastPage = -1;
                        $scope.totalPages = Math.ceil($scope.totalNoOfRecs/$scope.pageSize);
                        $scope.prevReviewsPage = function(){
                            if($scope.currentPageNo > 1){
                                $scope.overallAction = $scope.vendorActionList[0].lblVal;
                                $scope.currentPageNo = $scope.currentPageNo - 1; 
                                $scope.currentIndex -= $scope.pageSize;
                                //$scope.currentRange = ($scope.currentIndex + 1) + ' - ' + ($scope.currentIndex + $scope.pageSize );
                                if($scope.allDataFetched){
                                    $scope.allDataFetched = false;
                                    $scope.lastPage = $scope.currentPageNo + 1;
                                }
                            }
                        }
    
                        $scope.nextReviewsPage = function(){
                            //$scope.totalPages = Math.ceil($scope.SelectedComReviewListArray.length/$scope.pageSize);
                            if(!$scope.allDataFetched){
                                $scope.currentIndex += $scope.pageSize;
                                $scope.currentPageNo = $scope.currentPageNo + 1; 
                                $scope.overallAction = $scope.vendorActionList[0].lblVal;
                                //$scope.currentRange = ($scope.currentIndex + 1) + ' - ' + ($scope.currentIndex + $scope.pageSize );
                                if($scope.lastPage != -1 && $scope.lastPage == $scope.currentPageNo){
                                    $scope.allDataFetched = true;
                                }
                                if($scope.currentPageNo > $scope.fetchedTill){
                                    $scope.fetchedTill += 1;
                                    $scope.searchComRcrd($scope.lastID);
                                }

                                $scope.popupConfirm('Kindly Review Additional Terms or Dynamic Notifications.',function(){},function(){},false);
                                //console.log($scope.SelectedComReviewListArray.length);
                            }
                        }

                        $scope.SelectedComReviewListCurrentPage = {};
                        $scope.attachmentWithComRevId = {};

                        $scope.searchComRcrd = function(lastRecId) {
                            showLoading();
                            CNT_TPA_CommercialReviewForm.getRelatedComList( getParameterByName('id').trim(),getParameterByName('CSId').trim(), getParameterByName('viewMode').trim(), getParameterByName('TPCountryId').trim(),getParameterByName('TPUSId').trim() ,getParameterByName('MGMTId').trim(),lastRecId, function(result, event)
                                {
                                    if(event.type == 'exception')
                                        return false;
                                    else {
                                        $scope.SelectedComReviewListCurrentPage = {};
                                        console.log($scope.SelectedComReviewListCurrentPage.length+'---,,,,,');

                                        var tempID = getParameterByName('tempID').trim();
                                        var tempEmailIds ;
                                        if(tempID !=null && tempID != undefined){
                                            tempEmailIds = tempID.split(';');
                                        }

                                        if(result == null || result == '' || result.length < 1){
                                            $scope.postSubmitActivity('VFP_TPA_Page_Status?type=commercialrecordsdne')
                                        }
                                        angular.forEach(result, function(value, key) {
                                            if(value != null){
                                                var keyCustom = $scope.createKeyInitial(value.comRev);
                                                var isTempMatchFound = true;
	                                            if(tempEmailIds !=null && tempEmailIds != undefined && value.comRev.Receiver_s_Email__c != null && value.comRev.Receiver_s_Email__c != undefined){
	                                                var recieverEmails = value.comRev.Receiver_s_Email__c.split(';');
	                                                    for(var i = 0; i < tempEmailIds.length; i++) {
	                                                        if(value.comRev.Temporary_Reviewer_s_Email__c != null && !value.comRev.Temporary_Reviewer_s_Email__c.includes(tempEmailIds[i])){
	                                                            isTempMatchFound = false;
	                                                        }
	                                                    }
	                                            }
	                                            if(isTempMatchFound == true){	   
												    $scope.SelectedComReviewList[keyCustom] = value.comRev;
	                                                $scope.SelectedComReviewListCurrentPage[keyCustom] = value.comRev;
	                                                if(value.attachmentId != undefined)
	                                                    $scope.attachmentWithComRevId[value.comRev.Id] = value.attachmentId;
	                                            }else{
                                                	$scope.totalNoOfRecs--;
                                            	}   
                                                $scope.lastID = value.comRev.Id;                                         
                                            }
                                        });

                                        
                                        if($scope.SelectedComReviewList.length == $scope.totalNoOfRecs){
                                            $scope.allDataFetched = true;
                                        }
                                        
										$scope.findcorrectData();
                                        $scope.loadallData();
                                        $scope.applyChanges();
                                        hideLoading();
                                    }
                                },{escape: false});

                        }

                        $scope.findcorrectData = function() {
                            var CSId = getParameterByName('CSId').trim();
                            var viewMode = getParameterByName('viewMode').trim();
                            var TPCountryId = getParameterByName('TPCountryId').trim();
                            var TPUSId = getParameterByName('TPUSId').trim();
                            var MGMTId = getParameterByName('MGMTId').trim();
                            var LGLId = getParameterByName('LGLId').trim();
                            var AMAAdminId = getParameterByName('AMAAdminId').trim();
                            var listEmailIds;
                            $scope.comReasonsList = [];                        
                            if($scope.SelectedComReviewList != null && Object.keys($scope.SelectedComReviewList).length > 0){
                                if(CSId != null && viewMode != null && viewMode.indexOf('CSubmit') != -1){
                                    listEmailIds = CSId.split(';');
                                    listEmailIds = listEmailIds.sort();
                                    var comRevEmail = listEmailIds.join(';');
                                    $.each($scope.SelectedComReviewList, function(index,reviewCom) {
                                        
                                        if(reviewCom.Action_Needed_By__c != null){
                                            
                                            if(reviewCom.Manual_Review_Reason__c.indexOf('Offering Requires Secondary Commercial Review') > -1){
                                                var ActionBy = reviewCom.Action_Needed_By__c.toLowerCase();
                                                if((ActionBy.indexOf('commercial owner') > -1 || ActionBy.indexOf('mgmt') > -1 || ActionBy.indexOf('legal')  > -1 ) && reviewCom.Receiver_s_Email__c != null){
                                                    var recieverEmails = reviewCom.Receiver_s_Email__c.split(';');
                                                    recieverEmails = recieverEmails.sort();
                                                    var comRevEmail2 = recieverEmails.join(';');
                                                    if((comRevEmail2 == comRevEmail) && (viewMode != 'SCSubmit' || (viewMode == 'SCSubmit' && (reviewCom.Manual_Review_Reason__c == 'Offering Requires Secondary Commercial Review' || reviewCom.Manual_Review_Reason__c.indexOf('Vendor - Use - Offering Secondary Review by') > -1 || reviewCom.Manual_Review_Reason__c.indexOf('Vendor - Use Secondary Review by') > -1)))){
                                                        $scope.comReasonsList.push(reviewCom);
                                                    }
                                                }
                                            }else{
                                                var ActionBy = reviewCom.Action_Needed_By__c.toLowerCase();
                                                if((ActionBy.indexOf('commercial owner') > -1 || ActionBy.indexOf('mgmt') > -1 || ActionBy.indexOf('legal')  > -1 ) && reviewCom.Receiver_s_Email__c != null){
                                                    var recieverEmails = reviewCom.Receiver_s_Email__c.split(';');
                                                    recieverEmails = recieverEmails.sort();
                                                    var comRevEmail2 = recieverEmails.join(';');
                                                    if((comRevEmail2 == comRevEmail) && (viewMode != 'SCSubmit' || (viewMode == 'SCSubmit' && (reviewCom.Manual_Review_Reason__c == 'Offering Requires Secondary Commercial Review' || reviewCom.Manual_Review_Reason__c.indexOf('Vendor - Use - Offering Secondary Review by') > -1 || reviewCom.Manual_Review_Reason__c.indexOf('Vendor - Use Secondary Review by') > -1)))){
                                                        $scope.comReasonsList.push(reviewCom);
                                                    }
                                                }
                                            }
                                            
                                        }
                                        
                                    });
                                    
                                }
                                else if(TPCountryId != null && viewMode != null && (viewMode.indexOf('TPSubmit') != -1 || viewMode == 'TPSubmit')){
                                    listEmailIds = TPCountryId.split(';');
                                    listEmailIds = listEmailIds.sort();
                                    var comRevEmail = listEmailIds.join(';');
                                    $.each($scope.SelectedComReviewList, function(index,reviewCom) {
                                        if(reviewCom.Action_Needed_By__c != null && reviewCom.Action_Needed_By__c.indexOf('TP-Country') != -1 && reviewCom.TP_Country_Email__c != null){
                                            var recieverEmails = reviewCom.TP_Country_Email__c.split(';');
                                            recieverEmails = recieverEmails.sort();
                                            var comRevEmail2 = recieverEmails.join(';');
                                            if(comRevEmail2 == comRevEmail){
                                                $scope.comReasonsList.push(reviewCom);
                                            }
                                            $scope.$log.info('$scope.addHocReviewTPh'+ $scope.addHocReviewTP );
                                            if(comRevEmail2 == comRevEmail && (reviewCom.Manual_Review_Reason__c.indexOf('Additional Term(s) Added') != -1 || reviewCom.Manual_Review_Reason__c.indexOf('Renewal includes an Ad-hoc Additional Term') != -1)){
                                                $scope.addHocReviewTP = true;
                                            }
                                            $scope.$log.info('$scope.addHocReviewTPh'+ $scope.addHocReviewTP );
                                        }
                                    });
                                }
                                    else if(TPUSId != null && viewMode != null && (viewMode.indexOf('TPUS') != -1 || viewMode == 'TPUS') ){
                                        listEmailIds = TPUSId.split(';');
                                        listEmailIds.sort();
                                        var comRevEmail = listEmailIds.join(';');
                                        $.each($scope.SelectedComReviewList, function(index,reviewCom) {
                                            if(reviewCom.Action_Needed_By__c != null && reviewCom.Action_Needed_By__c.indexOf('TP-US') != -1 && reviewCom.TP_US_Email__c != null){
                                                var recieverEmails = reviewCom.TP_US_Email__c.split(';');
                                                recieverEmails = recieverEmails.sort();
                                                var comRevEmail2 = recieverEmails.join(';');
                                                if(comRevEmail2 == comRevEmail){
                                                    $scope.comReasonsList.push(reviewCom);
                                                }
                                            }
                                        });
                                    }
                                        else if(MGMTId != null && viewMode != null && (viewMode.indexOf('MGMT') != -1 || viewMode == 'MGMT') ){
                                            $.each($scope.SelectedComReviewList, function(index,reviewCom) {
                                                if(reviewCom.Manual_Review_Reason__c == 'Vendor Requires Secondary Review'){
                                                    $scope.comReasonsList.push(reviewCom);
                                                }
                                            });
                                        }
                                        else if(LGLId != null && viewMode != null && (viewMode.indexOf('LGL') != -1 || viewMode == 'LGL') ){
                                            $.each($scope.SelectedComReviewList, function(index,reviewCom) {
                                                if(reviewCom.Manual_Review_Reason__c == 'IQVIA Legal Approval Required: [New] TPA: Ad-hoc Additional Term Requested' || reviewCom.Manual_Review_Reason__c == 'IQVIA Legal Approval Required: [Renew] TPA: Ad-hoc Additional Term Requested'
                                                || reviewCom.Manual_Review_Reason__c == 'IQVIA Legal Approval Required: Prior TLLA had an Additional Term and/or Exhibit added and to be Renewed' || reviewCom.Manual_Review_Reason__c == 'IQVIA Legal Approval Required: New TPA - Ad-hoc Additional Term(s) / Exhibit Page(s) Requested'
                                                ){
                                                    $scope.comReasonsList.push(reviewCom);
                                                }
                                            });
                                        }
                                        else if(AMAAdminId != null && viewMode != null && (viewMode.indexOf('AMAAdmin') != -1 || viewMode == 'AMAAdmin') ){
                                            $.each($scope.SelectedComReviewList, function(index,reviewCom) {
                                                if(reviewCom.Manual_Review_Reason__c == 'Client does not have an AMA agreement' || reviewCom.Manual_Review_Reason__c == "Client's ama agreement is expired"){
                                                    $scope.comReasonsList.push(reviewCom);
                                                }
                                            });
                                        }

                            $scope.tempSelectedComReviewList =  {} ;
                            $scope.isSubmitButtonEnabled = true;
                            $.each($scope.comReasonsList, function(index,comReview) {
                                if(comReview.Action__c != null && comReview.Commercial_Owner_Name__c != null && comReview.Is_ReviewForm_Acknowledged__c){
                                    $scope.oldCommercialOwnerName = comReview.Commercial_Owner_Name__c;
                                }
                                if(!comReview.Is_ReviewForm_Acknowledged__c){
                                    $scope.isSubmitButtonEnabled = false;
                                }
                                $scope.tempSelectedComReviewList[comReview.Id] = comReview;
                            });
                            if($scope.isSubmitButtonEnabled && $scope.currentPageNo < $scope.totalPages){
                                $scope.isSubmitButtonEnabled = false;
                            }
                            $scope.SelectedComReviewList = $scope.tempSelectedComReviewList;
                            }   
                        }

                          
                        $scope.optionsAndOtherTaskDone = false;
                        $scope.loadallData = function() {
                            $scope.$log.info('In Load all Data');

                            if(getParameterByName('id').trim().length > 0)
                            {

                                $scope.objTpaRequestToEdit = {!ObjectTpaRequestToEdit};
                                if($scope.oldCommercialOwnerName != '' && $scope.isSubmitButtonEnabled){
                                    $scope.commercialOwnerName = $scope.oldCommercialOwnerName;
                                }
                                $scope.TextEditorList = {!ObjectMapOfIdWithTextEditorObj};
                                $scope.$log.info('$scope.TextEditorList'+JSON.stringify($scope.TextEditorList));
                                $scope.$log.info('$scope.SelectedComReviewList 1'+JSON.stringify($scope.SelectedComReviewList));
                                $scope.TextAdditionalTermsTemp = {!ObjectMapTpaTextAdditionalTerms};
                                $scope.TpaTextTerms = [];
                                $scope.TpaAdditionalTermsTemp = {!ObjectMapTpaAdditionalTerms};
                                $scope.TpaDynamicNotificationsTemp = {!ObjectMapTpaDynamicNotifications};
                                var southAfricaOfferingsLabel = '{!$Label.TPA_SubNational_Offerings}';
                                $scope.SouthAfricaOfferings = southAfricaOfferingsLabel.split(';');
                                $scope.TpaDynamicNotifications = {};
                                $scope.TpaAdditionalTerms = {};
                                $scope.useAddocAdditionalTerms = {};
                                $scope.useOfferingAddocAdditionalTerms = {};
                                $scope.TextAdditionalTerms = {};
                                $scope.TpaSouthAfricaTerms = [];
                                $scope.isUseTermsTabVisible = false;
                                $scope.isUseOfferingTermsTabVisible = false;
                                $scope.isOfferingTermsTabVisible = false;
                                $scope.$log.info('$scope.SouthAfricaOfferings'+JSON.stringify($scope.SouthAfricaOfferings));
                                $scope.$log.info('$scope.TextAdditionalTermsTemp'+JSON.stringify($scope.TextAdditionalTermsTemp));
                                $scope.$log.info('$scope.TpaAdditionalTermsTemp'+JSON.stringify($scope.TpaAdditionalTermsTemp));
                                $scope.$log.info('$scope.TpaDynamicNotificationsTemp'+JSON.stringify($scope.TpaDynamicNotificationsTemp));

                                //common loop for all sections
                                $scope.useNames = new Set();
                                $scope.offeringNames = new Set();
                                $scope.countryNames = new Set();
                                angular.forEach($scope.SelectedComReviewList, function(value1, key1) {
                                            //$scope.$log.info('$scope.TextAdditionalTerms2'+JSON.stringify(value));
                                    if(value1.Associated_Use_to_Review__c != null){
                                        $scope.useNames.add(value1.Associated_Use_to_Review__c);
                                    }
                                    if(value1.Associated_Offering_to_Review__c != null){
                                        let offName = value1.Associated_Offering_to_Review__c.indexOf(':') > -1 ? (value1.Associated_Offering_to_Review__c.split(':')[0] + '') :  value1.Associated_Offering_to_Review__c;                                   
                                        console.log(offName);
                                        $scope.offeringNames.add(offName);
                                        $scope.countryNames.add(value1.BU__c);
                                        if(value1.Associated_Offering_to_Review__c.indexOf('MIDAS') != -1 ){
                                            $scope.TpaTextTerms.push('is_Midas__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Patient Reference File') != -1 ){
                                            $scope.TpaTextTerms.push('is_Patient_Reference_File__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('GE Centricity EMR') != -1 ){
                                            $scope.TpaTextTerms.push('is_GE_Centricity_EMR__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Promo') != -1 ){
                                            $scope.TpaTextTerms.push('is_Promotrak__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Managed Care Workbook') != -1 ){
                                            $scope.TpaTextTerms.push('is_Managed_Workbook__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('IQVIA Global Promo.track™') != -1 ){
                                            $scope.TpaTextTerms.push('Is_Glbl_PromoTrack_Selected__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('IQVIA Consumer Aisle') != -1 ){
                                            $scope.TpaTextTerms.push('is_South_Africa_Consumer_Health__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('PharMetrics® Plus') != -1 ){
                                            $scope.TpaTextTerms.push('IS_Health_Plan_Claims__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Patient Companion File') != -1 ){
                                            $scope.TpaTextTerms.push('is_Patient_Companion_File__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Provider Companion File') != -1 ){
                                            $scope.TpaTextTerms.push('is_Provider_Companion_File__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Payer Companion File') != -1 ){
                                            $scope.TpaTextTerms.push('is_Payer_Companion_File__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('LAAD - Longitudinal Access and Adjudication Data') != -1 ){
                                            $scope.TpaTextTerms.push('is_LAAD_Offering__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Oncology electronic medical records data') != -1){
                                            $scope.TpaTextTerms.push('Is_Oncology_EMR__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Ambulatory electronic medical records data') != -1 ){
                                            $scope.TpaTextTerms.push('Is_Ambulatory_EMR__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Xponent') != -1 || value1.Associated_Offering_to_Review__c.indexOf('OneKey') != -1){
                                            $scope.TpaTextTerms.push('is_Xponent_or_OneKey__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Xponent PlanTrak') != -1 ){
                                            $scope.TpaTextTerms.push('is_Xponent__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Medpages Data') != -1 ){
                                            $scope.TpaTextTerms.push('Is_MedPages_Data__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('AIM XR Web Search/Social Insights') != -1 ){
                                            $scope.TpaTextTerms.push('is_AIM_XR__c');
                                        }
                                        if(value1.Associated_Offering_to_Review__c.indexOf('Analytics Link – Client Extract Only – No 3rd Party tool access included') != -1 ){
                                            $scope.TpaTextTerms.push('is_Analytics_Link__c'); 
                                        }
                                    }
                                    if($scope.SouthAfricaOfferings != null ){
                                        for(var i = 0; i<$scope.SouthAfricaOfferings.length ; i++){
                                            if(value1.Associated_Offering_to_Review__c != null && $scope.SouthAfricaOfferings[i] == value1.Associated_Offering_to_Review__c){
                                                $scope.TpaTextTerms.push('Is_South_Africa_Sub_Off__c');
                                            }
                                        }                            
                                    } 
                                    let dddOfferingSet = '{!$Label.TPA_DDD_Offering}' != null ? '{!$Label.TPA_DDD_Offering}'.split(';') : null ;
                                    if(dddOfferingSet != null){
                                        for(var i = 0; i<dddOfferingSet.length ; i++){
                                            if(value1.Associated_Offering_to_Review__c != null && dddOfferingSet[i] == value1.Associated_Offering_to_Review__c){
                                                $scope.TpaTextTerms.push('isDDDOffering__c');
                                            }
                                        }
                                    }
                                });
                                if($scope.TextAdditionalTermsTemp != null){
                                    //angular.forEach($scope.TextAdditionalTermsTemp, function(value, key) {
                                    if($scope.TpaTextTerms != null){
                                        for(var i = 0; i<$scope.TpaTextTerms.length ; i++){
                                            if( !$scope.TextAdditionalTerms.hasOwnProperty($scope.TpaTextTerms[i] + ':IMS_Legal_Entity__c')){
                                                $scope.TextAdditionalTerms[$scope.TpaTextTerms[i] +  ':IMS_Legal_Entity__c'] = $scope.TextAdditionalTermsTemp[$scope.TpaTextTerms[i] + ':IMS_Legal_Entity__c'];
                                                $scope.isOfferingTermsTabVisible = true;
                                            }
                                        }
                                    }
                                    //});
                                }
                                $scope.$log.info('$scope.TextAdditionalTerms'+JSON.stringify($scope.TextAdditionalTerms));
                                if($scope.TpaAdditionalTermsTemp != null){
                                    angular.forEach($scope.TpaAdditionalTermsTemp, function(value, key) {
                                        if(value.Category__c != null && value.Category__c == 'Use Specific Ad-Hoc Terms' && value.Use_Name__c != null && $scope.useNames.has(value.Use_Name__c)){
                                            if(!$scope.useAddocAdditionalTerms.hasOwnProperty(key)){
                                                   $scope.useAddocAdditionalTerms[key] = value;
                                                   $scope.isUseTermsTabVisible = true;
                                            }
                                        }
                                        if(value.Category__c != null && value.Category__c == 'Use/Offering Specific Ad-Hoc Terms' && value.Use_Name__c != null && $scope.useNames.has(value.Use_Name__c)){
                                            if(value.Country_of_Offering__c != null && $scope.countryNames.has(value.Country_of_Offering__c) && ($scope.offeringNames.has(value.Primary_Offering_Name__c) || (value.Secondary_Offering_Name__c != null && $scope.offeringNames.has(value.Secondary_Offering_Name__c)))){
                                                if(!$scope.useOfferingAddocAdditionalTerms.hasOwnProperty(key)){
                                                    $scope.useOfferingAddocAdditionalTerms[key] = value;
                                                    $scope.isUseOfferingTermsTabVisible = true;
                                                }
                                            }
                                        }
                                        //angular.forEach($scope.SelectedComReviewList, function(value1, key1) {
                                        if(value.Category__c != null && value.Category__c == 'Data Asset Specific Ad-Hoc Term' && value.Country_of_Offering__c != null && $scope.countryNames.has(value.Country_of_Offering__c) && ($scope.offeringNames.has(value.Primary_Offering_Name__c) || (value.Secondary_Offering_Name__c != null && $scope.offeringNames.has(value.Secondary_Offering_Name__c)))){
                                            if(!$scope.TpaAdditionalTerms.hasOwnProperty(key)){
                                                   $scope.TpaAdditionalTerms[key] = value;
                                                   $scope.isOfferingTermsTabVisible = true;
                                            }
                                        }
                                        //});
                                    });
                                }
                                $scope.$log.info('$scope.TpaAdditionalTerms'+JSON.stringify($scope.TpaAdditionalTerms));
                                if($scope.TpaDynamicNotificationsTemp != null){
                                    angular.forEach($scope.TpaDynamicNotificationsTemp, function(value, key) {
                                        if($scope.offeringNames.has(value.Primary_Data_Asset_Name__c) || $scope.offeringNames.has(value.Secondary_Data_Asset_Name__c)){
                                            if(!$scope.TpaDynamicNotifications.hasOwnProperty(value.Offering_Notifications__r.Page_Name__c)){
                                               $scope.TpaDynamicNotifications[value.Offering_Notifications__r.Page_Name__c] = value;
                                               $scope.isOfferingTermsTabVisible = true;
                                            }    
                                        }
                                       //angular.forEach($scope.SelectedComReviewList, function(value1, key1) {
                                           /*if(value1.Associated_Offering_to_Review__c == null && $scope.viewMode != 'CSubmit'){
                                               if(!$scope.TpaDynamicNotifications.hasOwnProperty(key)){
                                                   $scope.TpaDynamicNotifications[key] = value;
                                                   $scope.isOfferingTermsTabVisible = true;
                                               }
                                           }*/
                                       //});
                                   }); 
                                }
                                $scope.$log.info('$scope.SelectedComReviewList befor insert'+$scope.SelectedComReviewListCurrentPage.length);

                                    
                                    $scope.comReviewLglEnt = new Set({!otherDataAssetsKeys});
                                    angular.forEach($scope.SelectedComReviewListCurrentPage, function(value, key) {
                                        

                                        if($scope.SelectedComReviewListCurrentPage[key] != null && value.Manual_Review_Reason__c != null){
                                            var offering = (value.Associated_Offering_to_Review__c != null) ? value.Associated_Offering_to_Review__c : '' ;
                                            var use = (value.Associated_Use_to_Review__c != null) ? value.Associated_Use_to_Review__c : '';
                                            var useCategory = (value.Associated_Offering_s_Use_Category_s__c != null) ? value.Associated_Offering_s_Use_Category_s__c : '';
                                            var comOwnerName = (value.Commercial_Owner_Name__c != null) ? value.Commercial_Owner_Name__c : '';
                                            var action = (value.Action__c != null) ? value.Action__c : '--None--';
                                            if(value.Action__c != null && value.Action__c == 'Assigned to Commercial Owner (CO) – Awaiting CO Review' && $scope.viewMode == 'CSubmit'){
                                                action = '--None--';
                                            }
                                            var selLegalEntityVal = (value.IMS_Legal_Entity__c != null) ? value.IMS_Legal_Entity__c : 'Select Other - Offering IQVIA Legal Entity Here';
                                            var buVal = (value.BU__c != null) ? value.BU__c : '';
                                            var addTermName = value.TPA_Additional_Term__c != null ? value.TPA_Additional_Term__r.Term_Name__c : '';
                                            var addTerm = value.TPA_Additional_Term__c != null ? value.TPA_Additional_Term__r.Addtional_Term__c : '';
                                            var addTermCategory = value.TPA_Additional_Term__c != null ? value.TPA_Additional_Term__r.Category__c : '';
                                            var isAddTermUpdated = (value.TPA_Additional_Term__c != null && value.TPA_Additional_Term__r.CreatedDate != value.TPA_Additional_Term__r.LastModifiedDate && !value.Is_Future_Approved__c) ? true : false;
                                            var actionvalue = (value.Action__c != null && value.Action__c == 'Questions / Comments' && value.Additional_Questions_For_TP_Processor__c != null ) ? value.Additional_Questions_For_TP_Processor__c : '';
                                            var actionvalue4 = (value.Action__c != null && value.Action__c == 'Under Validation' && value.Comment_For_Under_Validation__c != null) ? value.Comment_For_Under_Validation__c : '';
                                            var actionvalue3 = (value.Action__c != null && value.Action__c == 'Potential Denial - Request TP Processor to arrange meeting with IQVIA Legal' && value.Additional_Text_For_Potential_Denial__c != null) ? value.Additional_Text_For_Potential_Denial__c : '';
                                            var actionvalue2 = (value.Action__c != null && ($scope.viewMode.indexOf('TPSubmit') != -1 || $scope.viewMode == 'TPSubmit') && value.Action__c == 'Assigned to Commercial Owner (CO) – Awaiting CO Review' && value.Receiver_s_Email__c != null) ? value.Receiver_s_Email__c : '';
                                            var legalEntityPresent = (value.Id != null && $scope.comReviewLglEnt != null && $scope.comReviewLglEnt.has($scope.createKey(value)))? false : true;
                                            var comRev = {id: value.Id,
                                                reason: $scope.removeSpecialSymbols(value.Manual_Review_Reason__c), 
                                                offering: $scope.removeSpecialSymbols(offering),
                                                useCategory: useCategory,
                                                use: $scope.removeSpecialSymbols(use),
                                                action: action,
                                                prevActionVal: action,
                                                actionvalue: actionvalue,
                                                actionvalue2: actionvalue2,
                                                actionvalue3: actionvalue3,
                                                actionvalue4: actionvalue4,
                                                additionalTermName: addTermName,
                                                additionalTerm: addTerm,
                                                additionalTermCategory: addTermCategory,
                                                addTermUpdated: isAddTermUpdated,
                                                legalEntityPresent: legalEntityPresent,
                                                bu: buVal,
                                                selLegalEntity: selLegalEntityVal,
                                                isacknowledged: value.Is_ReviewForm_Acknowledged__c,
                                                requestId: value.TPA_Request__c,
                                                commownername: comOwnerName,
                                                attachment: $scope.attachmentWithComRevId[value.Id] != null ? ($scope.attachmentWithComRevId[value.Id]) : '',
                                                reviewdate: $scope.getDateInJS(value.Date_of_Action_Response__c)};

                                            if(comRev.reason.indexOf('Additional Term(s) Added') != -1 || comRev.reason.indexOf('Renewal includes an Ad-hoc Additional Term') != -1){
                                                $scope.tpProAddTermReviews.push(comRev);
                                            }
                                            else{
                                                $scope.SelectedComReviewListArray.push(comRev);
                                            }
                                        }
                                    });
                                    $scope.$log.info('$scope.TpaDynamicNotifications'+JSON.stringify($scope.TpaDynamicNotifications));

                              //  }
                                
                                $scope.$log.info('$scope.SelectedComReviewListArray'+JSON.stringify($scope.SelectedComReviewListArray));

                               // $scope.$log.info('selected map'+JSON.stringify($scope.SelectedComReviewMap));
                                
                                $scope.$log.info(JSON.stringify($scope.objTpaRequestToEdit));

                                if($scope.objTpaRequestToEdit == null || $scope.optionsAndOtherTaskDone)
                                    return false;

                                $scope.optionsAndOtherTaskDone = true;
                                $scope.tpaObj.clientProjectName = $scope.objTpaRequestToEdit.Client_Project_Name__c;
                                $scope.tpaObj.clientName = $scope.objTpaRequestToEdit.Client_Address__r.Name;
                                $scope.tpaObj.requestStatus = $scope.objTpaRequestToEdit.Request_Status__c;
                                $scope.attMsg = 'Attention: By entering your name, email address, and title you acknowledge that you are authorized to confirm compliance with the terms and conditions agreed to in the Third Party Limited License Agreement outlined above and that you hereby confirm that {!$Label.TPA_IQVIA_Keyword} Health Intellectual Property associated with this agreement has been 1) destroyed or 2) returned except for insubstantial amounts of {!$Label.TPA_IQVIA_Keyword} Health Data that were extracted from the original data set and incorporated into the client deliverables or the work product to create the client deliverables, 3) Access to client-managed licensed offerings has been revoked, or 4) Renewed with '+$scope.tpaObj.clientName+' and is In Effect.';
                                if($scope.objTpaRequestToEdit.Service_Provider_Address__c != null){
                                    $scope.tpaObj.vendorName = $scope.objTpaRequestToEdit.Service_Provider_Address__r.Name;
                                    if($scope.extensionRecCommercialReason || ($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c != null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__r.Vendor_Tier__c == 'Y') 
                                       || ($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c == null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.Vendor_Tier__c == 'Y' )) 
                                    {
                                        $scope.vendorchecklist = true;
                                    }
                                    if(($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c != null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__r.New_Vendor_Checklist__c) 
                                       || ($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c == null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.New_Vendor_Checklist__c )) 
                                    {
                                        $scope.newvendorchecklist = true;
                                    }
                                    if(($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c != null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__r.Pharma_Company_Checklist__c) 
                                       || ($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c == null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.Pharma_Company_Checklist__c )) 
                                    {
                                        $scope.vendorpharmachecklist = true;
                                    }
                                    if(($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c != null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__r.Legal_Firm_Checklist__c) 
                                       || ($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c == null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.Legal_Firm_Checklist__c )) 
                                    {
                                        $scope.vendorlegalfirmchecklist = true;
                                    }
                                    if(($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c != null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__r.Academia_Checklist__c) 
                                       || ($scope.objTpaRequestToEdit.Service_Provider_Address__r.Parent_Vendor_Name__c == null && $scope.objTpaRequestToEdit.Service_Provider_Address__r.Academia_Checklist__c )) 
                                    {
                                        $scope.vendoracademiachecklist = true;
                                    }
                                }
                                
                                $scope.tpaObj.requestName = $scope.objTpaRequestToEdit.Name;
                                $scope.tpaObj.requestId = $scope.objTpaRequestToEdit.Id;
                                
                                if($scope.objTpaRequestToEdit.Parent_Request__c != null){
                                    $scope.tpaObj.parentRequestName = $scope.objTpaRequestToEdit.Parent_Request__r.Name;
                                    $scope.tpaObj.parentRequestRenewed = $scope.objTpaRequestToEdit.Parent_Request__r.Is_Renewed__c;
                                    if($scope.objTpaRequestToEdit.Parent_Request__r.Renewed_As__c != null){
                                        $scope.tpaObj.parentRequestRenewedAs = $scope.objTpaRequestToEdit.Parent_Request__r.Renewed_As__c;
                                    }
                                }
                                $scope.$log.info('$scope.tpaObj.requestId'+$scope.tpaObj.requestId);
                                $scope.$log.info('$scope.tpaObj.parentRequestName'+$scope.tpaObj.parentRequestName);
                                $scope.$log.info('$scope.tpaObj.parentRequestRenewed'+$scope.tpaObj.parentRequestRenewed);
                                $scope.$log.info('$scope.tpaObj.parentRequestRenewedAs'+$scope.tpaObj.parentRequestRenewedAs);
                                
                                
                                if($scope.objTpaRequestToEdit.Vendor_Website__c != null){
                                    $scope.tpaObj.website = $scope.objTpaRequestToEdit.Vendor_Website__c;
                                }
                                if($scope.objTpaRequestToEdit.Renewed_Type__c != null){
                                    $scope.tpaObj.renewedType = $scope.objTpaRequestToEdit.Renewed_Type__c;
                                }
                                if($scope.objTpaRequestToEdit.Renewed_As__c != null){
                                    $scope.tpaObj.renewedTPA = $scope.objTpaRequestToEdit.Renewed_As__r.Name;
                                    $scope.tpaObj.isPartialRenewed = $scope.objTpaRequestToEdit.Renewed_As__r.Is_Partially_Renewed__c;
                                }
                                $scope.lstDateSplitted = [];
                                $scope.tpaObj.dataAccessStartDate = $scope.objTpaRequestToEdit.Data_Access_Start_Date__c;
                                if($scope.tpaObj.dataAccessStartDate != null) {
                                    $scope.lstDateSplitted = $scope.tpaObj.dataAccessStartDate.split('-');
                                    $scope.tpaObj.dataAccessStartDate = $scope.lstDateSplitted[1]+'/'+$scope.lstDateSplitted[2]+'/'+$scope.lstDateSplitted[0];
                                }
                                $scope.lstDateSplitted2 = [];
                                $scope.tpaObj.dataAccessEndDate = $scope.objTpaRequestToEdit.Data_Access_End_Date__c;
                                $scope.$log.info('$scope.tpaObj.dataAccessEndDate'+$scope.tpaObj.dataAccessEndDate);
                                
                                if($scope.tpaObj.dataAccessEndDate != null) {
                                    $scope.lstDateSplitted2 = $scope.tpaObj.dataAccessEndDate.split('-');
                                    $scope.tpaObj.dataAccessEndDate = $scope.lstDateSplitted2[1]+'/'+$scope.lstDateSplitted2[2]+'/'+$scope.lstDateSplitted2[0];
                                }
                                
                                $scope.lstDateSplitted3 = [];
                                $scope.tpaObj.dataPeriodStartDate = $scope.objTpaRequestToEdit.Data_Period_Start_Date__c;
                                if($scope.tpaObj.dataPeriodStartDate != null) {
                                    $scope.lstDateSplitted3 = $scope.tpaObj.dataPeriodStartDate.split('-');
                                    $scope.tpaObj.dataPeriodStartDate = $scope.lstDateSplitted3[1]+'/'+$scope.lstDateSplitted3[2]+'/'+$scope.lstDateSplitted3[0];
                                }
                                $scope.lstDateSplitted4 = [];
                                $scope.tpaObj.dataPeriodEndDate = $scope.objTpaRequestToEdit.Data_Period_End_Date__c;
                                $scope.$log.info('$scope.tpaObj.dataPeriodEndDate'+$scope.tpaObj.dataPeriodEndDate);
                                
                                if($scope.tpaObj.dataPeriodEndDate != null) {
                                    $scope.lstDateSplitted4 = $scope.tpaObj.dataPeriodEndDate.split('-');
                                    $scope.tpaObj.dataPeriodEndDate = $scope.lstDateSplitted4[1]+'/'+$scope.lstDateSplitted4[2]+'/'+$scope.lstDateSplitted4[0];
                                }

                                var renewedOptionNameTemp = '{!$Label.TPA_Renewed_with}';
                                var renewedOptionName = renewedOptionNameTemp.replace('ClientCompanyNameStr', $scope.tpaObj.clientName) ;
                                var actionOption = {};
                                var actionOption2 = {};
                                var dupArray = [];
                                $scope.actionOptionUpdate = [];
                                $scope.actionOptionUpdateMap = {};
                                $scope.actionOptionUpdateMap2 = {};
                                actionOption = {'lbl' : '{!$Label.TPA_None}','lblVal' : '--None--'};
                                $scope.vendorActionList.push(actionOption);
                                $scope.vendorActionListForSecReview.push(actionOption);
                                if($scope.viewMode != null && ($scope.viewMode.indexOf('CSubmit') != -1 || $scope.viewMode == 'CSubmit')){
                                    actionOption = {'lbl' : '{!$Label.TPA_Approve_Manual_Trigger}','lblVal' : '{!$Label.TPA_Approve_Manual_Trigger}'};
                                	$scope.vendorActionList.push(actionOption);
                                    $scope.vendorActionListForSecReview.push(actionOption);
                                    actionOption = {'lbl' : '{!$Label.TPA_Approved_Future_Approved}','lblVal' : '{!$Label.TPA_Approved_Future_Approved}'};
                                	if( $scope.viewMode != 'SCSubmit'){
                                        $scope.vendorActionList.push(actionOption);
                                    }
                                    $scope.vendorActionListForSecReview.push(actionOption);
                                    actionOption = {'lbl' : '{!$Label.TPA_Need_Commercial_Inquiry}','lblVal' : '{!$Label.TPA_Need_Commercial_Inquiry}'};
                                	$scope.vendorActionList.push(actionOption);
                                    $scope.vendorActionListForSecReview.push(actionOption);
                                    actionOption = {'lbl' : '{!$Label.TPA_Potential_Denial_Request_TP_Processor_to_arrange_meeting_with_IQVIA_Legal}','lblVal' : '{!$Label.TPA_Potential_Denial_Request_TP_Processor_to_arrange_meeting_with_IQVIA_Legal}'};
                                	$scope.vendorActionList.push(actionOption);
                                    $scope.vendorActionListForSecReview.push(actionOption);
                                }
                                else if($scope.viewMode != null && ($scope.viewMode.indexOf('MGMT') != -1 || $scope.viewMode == 'MGMT')){
                                	actionOption = {'lbl' : '{!$Label.TPA_Approve_Manual_Trigger}','lblVal' : '{!$Label.TPA_Approve_Manual_Trigger}'};
                                	$scope.vendorActionList.push(actionOption);
                                    actionOption = {'lbl' : '{!$Label.TPA_Need_Commercial_Inquiry}','lblVal' : '{!$Label.TPA_Need_Commercial_Inquiry}'};
                                	$scope.vendorActionList.push(actionOption);
                                    actionOption = {'lbl' : '{!$Label.TPA_Potential_Denial_Request_TP_Processor_to_arrange_meeting_with_IQVIA_Legal}','lblVal' : '{!$Label.TPA_Potential_Denial_Request_TP_Processor_to_arrange_meeting_with_IQVIA_Legal}'};
                                	$scope.vendorActionList.push(actionOption);
                                }
                                else if($scope.viewMode != null && ($scope.viewMode.indexOf('LGL') != -1 || $scope.viewMode == 'LGL')){
                                	actionOption = {'lbl' : '{!$Label.TPA_Approve_Manual_Trigger}','lblVal' : '{!$Label.TPA_Approve_Manual_Trigger}'};
                                	$scope.vendorActionList.push(actionOption);
                                    actionOption = {'lbl' : '{!$Label.TPA_Approved_Future_Approved_AdHoc}','lblVal' : '{!$Label.TPA_Approved_Future_Approved_AdHoc}'};
                                	$scope.vendorActionList.push(actionOption);
                                    actionOption = {'lbl' : '{!$Label.TPA_Need_Commercial_Inquiry}','lblVal' : '{!$Label.TPA_Need_Commercial_Inquiry}'};
                                	$scope.vendorActionList.push(actionOption);
                                }
                                
                                    else if($scope.viewMode != null && ($scope.viewMode.indexOf('TPSubmit') != -1 || $scope.viewMode == 'TPSubmit' || $scope.viewMode == 'TPUS')) {
                                        if($scope.SelectedComReviewListArray != null) {
                                            $scope.$log.info('inside1234');
                                            for(var i=0; i<$scope.SelectedComReviewListArray.length ; i++) {
                                                if($scope.SelectedComReviewListArray[i].reason.indexOf('Other') != -1){
                                                    $scope.tpOtherReasonAvailable = true;
                                                }
                                                else {
                                                    $scope.tpOtherReasonNotAvailable = true;
                                                }
                                            }
                                        }
                                        if($scope.tpOtherReasonAvailable){
                                            $scope.vendorOtherActionList = [];
                                            actionOption = {'lbl' : '{!$Label.TPA_None}','lblVal' : '--None--'};
                                            $scope.vendorOtherActionList.push(actionOption);
                                            actionOption = {'lbl' : '{!$Label.TPA_Under_Validation}','lblVal' : '{!$Label.TPA_Under_Validation}'};
                                            $scope.vendorOtherActionList.push(actionOption);
                                            actionOption = {'lbl' : '{!$Label.TPA_Resolved_Assigned_to_Commercial}','lblVal' : '{!$Label.TPA_Resolved_Assigned_to_Commercial}'};
                                            $scope.vendorOtherActionList.push(actionOption);
                                        }
                                        if($scope.tpOtherReasonNotAvailable){
                                            $scope.vendorActionList = [];
                                            actionOption = {'lbl' : '{!$Label.TPA_None}','lblVal' : '--None--'};
                                            $scope.vendorActionList.push(actionOption);
                                            actionOption = {'lbl' : '{!$Label.TPA_Under_Validation}','lblVal' : '{!$Label.TPA_Under_Validation}'};
                                            $scope.vendorActionList.push(actionOption);
                                            actionOption = {'lbl' : '{!$Label.TPA_Completed}','lblVal' : '{!$Label.TPA_Completed}'};
                                            $scope.vendorActionList.push(actionOption);
                                        }
                                        
                                        
                                        }else if(($scope.viewMode?.indexOf('AMAAdmin') != -1 || $scope.viewMode == 'AMAAdmin')){
                                                $scope.vendorActionList = [];
                                                actionOption = {'lbl' : '{!$Label.TPA_None}','lblVal' : '--None--'};
                                                $scope.vendorActionList.push(actionOption);
                                                actionOption = {'lbl' : '{!$Label.TPA_CRAPL_Valid_AMA_Agreement_on_file}','lblVal' : '{!$Label.TPA_CRAPL_Valid_AMA_Agreement_on_file}'};
                                                $scope.vendorActionList.push(actionOption);
                                                actionOption = {'lbl' : '{!$Label.TPA_CRAPL_No_valid_AMA_Agreement_on_File}','lblVal' : '{!$Label.TPA_CRAPL_No_valid_AMA_Agreement_on_File}'};
                                                $scope.vendorActionList.push(actionOption);
                                                actionOption = {'lbl' : '{!$Label.TPA_Need_Commercial_Inquiry}','lblVal' : '{!$Label.TPA_Need_Commercial_Inquiry}'};
                                                $scope.vendorActionList.push(actionOption);
                                    	}

                                    if($scope.addHocReviewTP == true){
                                        $scope.tpProAddTermAction = [];
                                        actionOption = {'lbl' : '{!$Label.TPA_None}','lblVal' : '--None--'};
                                        $scope.tpProAddTermAction.push(actionOption);
                                        actionOption = {'lbl' : '{!$Label.TPA_Under_Validation}','lblVal' : '{!$Label.TPA_Under_Validation}'};
                                        $scope.tpProAddTermAction.push(actionOption);
                                        actionOption = {'lbl' : 'Confirmed - Include in Renewal','lblVal' : 'Confirmed - Include in Renewal'};
                                        $scope.tpProAddTermAction.push(actionOption);
                                        actionOption = {'lbl' : 'Confirmed - Include Updated Additional Term in Renewal ','lblVal' : 'Confirmed - Include Updated Additional Term in Renewal'};
                                        $scope.tpProAddTermAction.push(actionOption);
                                    }
                                $scope.overallAction = $scope.vendorActionList[0].lblVal;
                                $scope.$log.info('inside1234567'+JSON.stringify($scope.actionOptionUpdateMap));
                                $scope.$log.info('inside12345678'+JSON.stringify($scope.actionOptionUpdateMap2));
                                $scope.$log.info('inside1234'+JSON.stringify($scope.vendorActionList));
                                if($scope.vendorActionList.length == 1){
                                    $scope.otherReasonAvailable = true;
                                    actionOption = {'lbl' : '{!$Label.TPA_Under_Validation}','lblVal' : '{!$Label.TPA_Under_Validation}'};
                                    $scope.vendorActionList.push(actionOption);
                                    actionOption = {'lbl' : '{!$Label.TPA_Resolved_Assigned_to_Commercial}','lblVal' : '{!$Label.TPA_Resolved_Assigned_to_Commercial}'};
                                    $scope.vendorActionList.push(actionOption);
                                }
                                $scope.$log.info('inside1234'+JSON.stringify($scope.vendorOtherActionList));


                                $scope.commercialFormSubmitPopupMsg = 'Please Click ok to submit the Review Form';
                                
                                $scope.thirdPartyAccessProgramTPANumberTemp = '{!$Label.TPA_Third_Party_Access_Program_tpanumber}';
                                $scope.thirdPartyAccessProgramTPANumber = $scope.thirdPartyAccessProgramTPANumberTemp.replace('tpanumber',$scope.tpaObj.requestName);

                            }
                        }

                        $scope.createKey = function(comreview){
                            var key = '';
                            key +=comreview.Associated_Use_to_Review__c + ';';
                            
                            key +=comreview.Associated_Offering_s_Use_Category_s__c + ';';
                            key +=comreview.Associated_Offering_Category__c + ';';
                            key +=comreview.BU__c + ';';
                            if(comreview.Associated_Offering_to_Review__c != null && comreview.Associated_Offering_to_Review__c.indexOf('Other Offering Selected') > -1){
                                key += 'Other';
                            }
                            else if(comreview.Associated_Offering_to_Review__c != null && comreview.Associated_Offering_to_Review__c.indexOf(':') > -1){
                                key +=comreview.Associated_Offering_to_Review__c.split(':')[0];
                            }
                            else{
                                key +=comreview.Associated_Offering_to_Review__c;
                            }
                            return key;
                            
                        }

                        $scope.createKeyInitial = function(comreview){
                            var key = '';
                            if(comreview.Manual_Review_Reason__c != null && comreview.Manual_Review_Reason__c.indexOf('Additional Term') > -1){
                                key += comreview.TPA_Additional_Term__r.Term_Name__c + ';';
                                key += comreview.TPA_Additional_Term__r.Addtional_Term__c + ';';
                                key += comreview.TPA_Additional_Term__r.Category__c + ';';
                                key += comreview.TPA_Additional_Term__r.TPA_Legal_Entity_1__c + ';';
                                key += comreview.Manual_Review_Reason__c ;
                                return key;
                            }
                            key +=comreview.Associated_Use_to_Review__c + ';';
                            
                            key +=comreview.Associated_Offering_s_Use_Category_s__c + ';';
                            key +=comreview.Associated_Offering_Category__c + ';';
                            key +=comreview.BU__c + ';';
                            key +=comreview.Associated_Offering_to_Review__c+';';
                            key +=comreview.Manual_Review_Reason__c;
                            return key;
                            
                        }

                        $scope.getDateInJS = function(dateInJS){
      		                if(typeof dateInJS == 'number'){
            	                dateInJS = new Date(dateInJS);

                                var dd = dateInJS.getUTCDate();
                                var mm = dateInJS.getUTCMonth()+1;
                                if(dd<10){
                                    dd='0'+dd;
                                } 
                                if(mm<10){
                                    mm='0'+mm;
                                } 

                                var dateJstoStr = '' + mm + '/' + dd + '/' + dateInJS.getUTCFullYear() ;
                                return dateJstoStr;
                            }
                            return dateInJS;
	                    }

                        $scope.removeSpecialSymbols = function(val){
                            var e = document.createElement('textarea');
                            e.innerHTML = val;
                            // handle case of empty input
                            return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
                        }

                        
                        //*** loadForm function invokes when page loads (As Constructor) start ***//
                        $scope.loadForm = function() {
                            
                            //Shut down popup code start
                            var isPermanentDown = {!isTPAPermanentDown};
                            var isRestrictedUser = {!isRestrictedUser};
                            var portalDownMessage = '{!Message}';
                            $scope.lastID = null;
                            $(document).ready(function(){
                                if(isPermanentDown)
                                {
                                    popupAlert(portalDownMessage);
                                        $('.customPopupFooter .aButtons').css("display","none");
                                        $('#backWhiteOverlay').css("display", "");
                                        $('#pageBody').keydown(function(objEvent) {
                                            if (objEvent.keyCode == 9) {  //tab pressed
                                                objEvent.preventDefault(); // stops its action
                                            }
                                            if (objEvent.keyCode == 13) {  //enter pressed
                                                objEvent.preventDefault(); // stops its action
                                            }
                                        });
                                }
                                $scope.searchComRcrd($scope.lastID);
                            });
                            //shut down popup code end

                            $scope.$log.info($scope.tpaReqId);
                            $scope.tempcomEmailID = '';

                            if(getParameterByName('viewMode').trim().length > 0 ){
                    			$scope.viewMode = getParameterByName('viewMode').trim();
                			}
                            if(getParameterByName('CSId').trim().length > 0 ){
                    			$scope.comEmailID = getParameterByName('CSId').trim();
                			}
                            if(getParameterByName('MGMTId').trim().length > 0 || $scope.viewMode == 'SCSubmit'){
                    			$scope.comEmailID = getParameterByName('MGMTId').trim();
                                $scope.nameLabel = "Management Reviewer Name:";
                			}
                            if(getParameterByName('CSId').trim().length > 0 && $scope.viewMode == 'SCSubmit'){
                    			$scope.comEmailID = getParameterByName('CSId').trim();
                                $scope.nameLabel = "Management Reviewer Name:";
                			}
                            if(getParameterByName('LGLId').trim().length > 0 && $scope.viewMode == 'LGL'){
                                $scope.viewModeAddTerm = true;
                    			$scope.comEmailID = getParameterByName('LGLId').trim();
                                $scope.nameLabel = "Legal Reviewer Name:";
                			}
                            if(getParameterByName('tempID').trim().length > 0 ){
                                $scope.tempcomEmailID = getParameterByName('tempID').trim();
                            }
                            $scope.addHocReviewTP = false;
                            $scope.$log.info('viewMode'+$scope.viewMode);
                        }
                        $scope.goToComOwnerChangePage = function()
                        {
                            $scope.comOwnerChangeReqURL = '/imshealthPortal/VFP_TPA_Com_Owner_Change_Request_Form?CSId=' + $scope.comEmailID ;
                            window.location.href = $scope.comOwnerChangeReqURL;
                        }

                        $scope.postSubmitActivity = function(redirectionURL)
                        {
                            window.location.href = redirectionURL;
                        }

                        $scope.closeTabOnCancel = function(redirectionURL)
                        {
                            hideLoading();
                            $scope.$log.info('inside');
                            window.location.href = redirectionURL;
                        }

                        //*** function to submit request ***//
                        $scope.submitForm = function()
                        {
                            $scope.applyChanges();
                            $scope.$log.info('selected map inside submitform1'+JSON.stringify($scope.SelectedComReviewMap2));
                            $scope.$log.info('selected map inside submitform2'+JSON.stringify($scope.SelectedComReviewListArray));
                            if($scope.validateForm())
                                return false;
                            $scope.setComReviewToUpdate = [];
                            $scope.setComReviewToUpdateMap = {};
                            for(var i=0; i<$scope.SelectedComReviewListArray.length; i++){
                                var comId = $scope.SelectedComReviewListArray[i].id;
                                $scope.TPA_Commercial_Review__c = {};
                                $scope.TPA_Commercial_Review__c['Id'] = $scope.SelectedComReviewListArray[i].id;
                                /*if($scope.SelectedComReviewListArray[i].actionvalue != '' && $scope.SelectedComReviewListArray[i].actionvalue2 != ''){
                                    $scope.TPA_Commercial_Review__c['Additional_Questions_For_TP_Processor__c'] = $scope.SelectedComReviewListArray[i].actionvalue + ';' +$scope.SelectedComReviewListArray[i].actionvalue2 + ';';
                                }else */
                                $scope.TPA_Commercial_Review__c['Associated_Use_to_Review__c'] = $scope.SelectedComReviewListArray[i].use;
                                $scope.TPA_Commercial_Review__c['Associated_Offering_to_Review__c'] = $scope.SelectedComReviewListArray[i].offering;
                                if($scope.SelectedComReviewListArray[i].action == 'Questions / Comments' && $scope.SelectedComReviewListArray[i].actionvalue != ''){
                                    $scope.TPA_Commercial_Review__c['Additional_Questions_For_TP_Processor__c'] = $scope.SelectedComReviewListArray[i].actionvalue;
                                }
                                else if($scope.SelectedComReviewListArray[i].action == 'Assigned to Commercial Owner (CO) – Awaiting CO Review' && ($scope.viewMode.indexOf('TPSubmit') != -1 || $scope.viewMode == 'TPSubmit') && $scope.SelectedComReviewListArray[i].actionvalue2 != ''){
                                    $scope.TPA_Commercial_Review__c['Receiver_s_Email__c'] = $scope.SelectedComReviewListArray[i].actionvalue2;
                                }
								else if($scope.SelectedComReviewListArray[i].action == 'Potential Denial - Request TP Processor to arrange meeting with IQVIA Legal' && $scope.SelectedComReviewListArray[i].actionvalue3 != ''){
                                    $scope.TPA_Commercial_Review__c['Additional_Text_For_Potential_Denial__c'] = $scope.SelectedComReviewListArray[i].actionvalue3;
                                }
								else if($scope.SelectedComReviewListArray[i].action == 'Under Validation' && $scope.SelectedComReviewListArray[i].actionvalue4 != ''){
                                    $scope.TPA_Commercial_Review__c['Comment_For_Under_Validation__c'] = $scope.SelectedComReviewListArray[i].actionvalue4;
                                }                                
                                $scope.TPA_Commercial_Review__c['TPA_Request__c'] = $scope.tpaReqId;
                                if(!$scope.SelectedComReviewListArray[i].legalEntityPresent && $scope.SelectedComReviewListArray[i].selLegalEntity != null && $scope.SelectedComReviewListArray[i].selLegalEntity != '' && $scope.SelectedComReviewListArray[i].selLegalEntity != 'Select Other - Offering IQVIA Legal Entity Here'){
                                    $scope.TPA_Commercial_Review__c['IMS_Legal_Entity__c'] = $scope.SelectedComReviewListArray[i].selLegalEntity;
                                }
                                if($scope.SelectedComReviewListArray[i].action == 'Approved for this specific TPA request'){
                                    $scope.TPA_Commercial_Review__c['Action__c'] = $scope.SelectedComReviewListArray[i].action;
                                    $scope.TPA_Commercial_Review__c['Status__c'] = 'Combination Approved';
                                }else if($scope.SelectedComReviewListArray[i].action == 'Approved for this specific TPA. The Vendor and specified Use(s) and IQVIA Offerings specific combination can be auto-approved moving forward for future requests'
                                || $scope.SelectedComReviewListArray[i].action == '{!$Label.TPA_Approved_Future_Approved_AdHoc}'){
                                    $scope.TPA_Commercial_Review__c['Action__c'] = $scope.SelectedComReviewListArray[i].action;
                                    $scope.TPA_Commercial_Review__c['Status__c'] = 'Combination Approved and Future Approved';
                                }else if($scope.SelectedComReviewListArray[i].action == 'Questions / Comments'){
                                    $scope.TPA_Commercial_Review__c['Action__c'] = 'Questions / Comments';
                                    $scope.TPA_Commercial_Review__c['Status__c'] = 'Pending TP Processor Response to Commercial Owner Questions or Comments';
                                }else if($scope.SelectedComReviewListArray[i].action == 'Potential Denial - Request TP Processor to arrange meeting with IQVIA Legal'){
                                    $scope.TPA_Commercial_Review__c['Action__c'] = $scope.SelectedComReviewListArray[i].action;
                                    $scope.TPA_Commercial_Review__c['Status__c'] = 'Pending TP Processor to Arrange meeting with IQVIA Legal via TP-US team';
                                }else if($scope.SelectedComReviewListArray[i].action == 'Under Validation'){
                                    $scope.TPA_Commercial_Review__c['Action__c'] = $scope.SelectedComReviewListArray[i].action;
                                    //$scope.TPA_Commercial_Review__c['Status__c'] = 'Under Validation';
                                }else if($scope.SelectedComReviewListArray[i].action == 'Complete'){
                                    $scope.TPA_Commercial_Review__c['Action__c'] = $scope.SelectedComReviewListArray[i].action;
                                    $scope.TPA_Commercial_Review__c['Status__c'] = 'Complete';
                                }else if($scope.SelectedComReviewListArray[i].action == 'Confirmed - Include in Renewal' || $scope.SelectedComReviewListArray[i].action == 'Confirmed - Include Updated Additional Term in Renewal'){
                                    $scope.TPA_Commercial_Review__c['Action__c'] = $scope.SelectedComReviewListArray[i].action;
                                    $scope.TPA_Commercial_Review__c['Status__c'] = 'Complete';
                                }else if($scope.SelectedComReviewListArray[i].action == 'Assigned to Commercial Owner (CO) – Awaiting CO Review'){
                                    $scope.TPA_Commercial_Review__c['Action__c'] = $scope.SelectedComReviewListArray[i].action;
                                    //$scope.TPA_Commercial_Review__c['Status__c'] = 'Under Validation';
		                        }else if($scope.SelectedComReviewListArray[i].action == 'No Valid AMA Agreement on File'){
		                            $scope.TPA_Commercial_Review__c['Action__c'] = 'No Valid AMA Agreement on File';
		                            $scope.TPA_Commercial_Review__c['Status__c'] = 'Pending TP Processor Response';
		                        }else if($scope.SelectedComReviewListArray[i].action == 'Valid AMA Agreement on File'){
		                            $scope.TPA_Commercial_Review__c['Action__c'] = 'Valid AMA Agreement on File';
		                            $scope.TPA_Commercial_Review__c['Status__c'] = 'Combination Approved';
                                }
                                
                                //$scope.TPA_Commercial_Review__c['Is_Restricted_Data__c'] = v.Is_Restricted_Data__c;
                                $scope.$log.info('inside submitform'+JSON.stringify($scope.TPA_Commercial_Review__c));
                                if(($scope.SelectedComReviewListArray[i].action != $scope.SelectedComReviewListArray[i].prevActionVal || (($scope.SelectedComReviewListArray[i].action.indexOf('Approved') > -1 || $scope.SelectedComReviewListArray[i].action.indexOf('Confirmed') > -1 || $scope.SelectedComReviewListArray[i].action.indexOf('Complete') > -1) && !$scope.SelectedComReviewListArray[i].isacknowledged)) && !$scope.setComReviewToUpdateMap.hasOwnProperty($scope.SelectedComReviewListArray[i].id + ':' + $scope.tpaReqId)) {
                                    $scope.TPA_Commercial_Review__c['Is_ReviewForm_Acknowledged__c'] = true;
                                    $scope.setComReviewToUpdateMap[$scope.SelectedComReviewListArray[i].id + ':' + $scope.tpaReqId] = angular.copy($scope.TPA_Commercial_Review__c);
                                    $scope.setComReviewToUpdate.push(angular.copy($scope.TPA_Commercial_Review__c));
                                }
                            	
                            }

                            angular.forEach($scope.tpProAddTermReviews,function(comRev,index){
                                console.log(comRev);
                                $scope.TPA_Commercial_Review__c = {};
                                $scope.TPA_Commercial_Review__c['Id'] = comRev.id;
                                $scope.TPA_Commercial_Review__c['TPA_Request__c'] = $scope.tpaReqId;
                                
                                if(comRev.action == 'Under Validation' && comRev.actionvalue4 != ''){
                                    $scope.TPA_Commercial_Review__c['Comment_For_Under_Validation__c'] = comRev.actionvalue4;
                                    $scope.TPA_Commercial_Review__c['Action__c'] = comRev.action;
                                }
                                else if(comRev.action == 'Confirmed - Include in Renewal' || comRev.action == 'Confirmed - Include Updated Additional Term in Renewal'){
                                    $scope.TPA_Commercial_Review__c['Action__c'] = comRev.action;
                                    $scope.TPA_Commercial_Review__c['Status__c'] = 'Complete';
                                }
                                if((comRev.action != comRev.prevActionVal || (comRev.action.indexOf('Confirmed') > -1 && !comRev.isacknowledged)) && !$scope.setComReviewToUpdateMap.hasOwnProperty(comRev.id + ':' + $scope.tpaReqId)) {
                                    $scope.TPA_Commercial_Review__c['Is_ReviewForm_Acknowledged__c'] = true;
                                    $scope.setComReviewToUpdateMap[comRev.id + ':' + $scope.tpaReqId] = angular.copy($scope.TPA_Commercial_Review__c);
                                    $scope.setComReviewToUpdate.push(angular.copy($scope.TPA_Commercial_Review__c));
                                }
                            });
                            
                            $scope.$log.info('selected map inside submitform4'+JSON.stringify($scope.setComReviewToUpdate));
                            
                            var addtitionalText = '';
                            if($scope.SelectedComReviewListArray.length == $scope.pageSize){
                                addtitionalText = 'There are more records to review . You can click on next button load more records else ';
                            }

                            $scope.popupConfirm( addtitionalText + $scope.commercialFormSubmitPopupMsg,   //Updated by Vikram Singh under ER-3221
                                                function(){
                                                    showLoading();
                                                    CNT_TPA_CommercialReviewForm.saveRequest(JSON.stringify($scope.setComReviewToUpdate).replace(/null/i, "\'\'"),$scope.commercialOwnerName, $scope.comEmailID,$scope.tempcomEmailID, function(result, event)
                                                    {
                                                        $scope.$log.warn(result);
                                                        if(event.type == 'exception')
                                                        {
                                                            hideLoading();
                                                            $scope.$log.info('Error: ' + event.message);
                                                            $scope.submitStatus = 'error';
                                                            return false;
                                                        }
                                                        if(result.indexOf('success') > -1)
                                                            $scope.postSubmitActivity(result.split('~')[1]);
                                                        else if(result.indexOf('{!$Label.TPA_You_have_selected_Other_Offering_please_update_the_Leagl_Entity}') > -1) {
                                                            hideLoading();
                                                            $scope.$log.info('Error: ' + result);
                                                            $scope.submitStatus = 'error';
                                                            $scope.isError = true;
                                                            $scope.errorMsg = '<ul><li>' + '{!$Label.TPA_You_have_selected_Other_Offering_please_update_the_Leagl_Entity}' + '</li></ul>';
                                                            window.scrollTo(0,0);
                                                            $scope.applyChanges();
                                                            return false;
                                                        } else {
                                                            hideLoading();
                                                            $scope.$log.info('Error: ' + event.message);
                                                            $scope.submitStatus = 'error';
                                                            return false;
                                                        }
                                                    },{timeout: 120000});
                                                },
                                                function(){},
                                                true);

                        }
                        //****** tpa request events end ******//

                        //****** Validation models start ******//
                        $scope.isError = false;
                        $scope.errorMsg = '';
                        //****** Validation models end ******//

                        //****** Angular Apply All Changes Event Start ******//
                        //*** function triggers and applies all angular scope changes explicitly ***//
                        $scope.applyChanges = function()
                        {
                            if ($scope.$root.$$phase != '$apply' && $scope.$root.$$phase != '$digest')
                                $scope.$apply();
                        }
                        //****** Angular Apply All Changes Event End ******//
                        
                        $scope.sortOrderChange = function(columnToSort, sortOrder)
                        {
                            if(columnToSort == $scope.columnSortBy)
                            {
                                if('asc' + sortOrder == $scope.sortOrder)
                                    $scope.sortOrder = 'desc' + sortOrder;
                                else
                                    $scope.sortOrder = 'asc' + sortOrder;
                                $scope.isDescending = !$scope.isDescending;
                            }
                            else
                            {
                                $scope.columnSortBy = columnToSort;
                                $scope.sortOrder = ($scope.sortOrder.indexOf('desc') != -1 ? 'desc' : 'asc') + sortOrder;
                            }
                        }
                        $scope.sortOrderChangeHeaderClick = function(columnToSort, sortOrder, sortOrderChange)
                        {
                            if(columnToSort != null){
                                $scope.sortOrderChange(columnToSort, sortOrder);
                            }
                            else if(sortOrderChange == 'true')
                            {
                                $scope.sortOrder = $scope.sortOrder.indexOf('desc') != -1 ? $scope.sortOrder.replace('desc', 'asc') : $scope.sortOrder.replace('asc', 'desc');
                            }
                                else if(sortOrderChange == 'false')
                                {
                                    $scope.sortOrder = ($scope.sortOrder.indexOf('desc') != -1 ? 'desc' : 'asc') + $("#ddSortData option:selected").text().replace(/ /g,'');
                                }
                            
                            $scope.applyChanges();
                        }

                        $scope.renderBootstrapTooltip = function()
                        {
                            applyBootstrapTooltip('right', '.rightTooltip');
                            applyBootstrapTooltip('left', '.leftTooltip');
                            applyBootstrapTooltip('bottom', '.bottomTooltip');
                            applyBootstrapTooltip('top', '.topTooltip');
                        }

                        //****** Utility Events Start ******//

                        //*** utility function to validate Email Pattern. ***//
                        $scope.isValidEmail = function(sEmail)
                        {
                            var filter = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                            var diacriticscharacterfilter = /([\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+/g;
                    
                            if (filter.test(sEmail) && !diacriticscharacterfilter.test(sEmail)) { 
                                return true;
                            }
                            else
                                return false;
                        }
                        $scope.isValidRequestNo = function(sReqNum)
                        {
                            var filter = /^([0-9]{5}|[0-9]{7})$/;
                            if (filter.test(sReqNum)) {
                                return true;
                            }
                            else
                                return false;
                        }
                        $scope.popupAlert = function(msg, truePart)
                        {
                            popup(msg, {'animate':true},
                            function(r)
                            {
                                if(r && truePart != null)
                                    truePart();
                            });
                        }

                        $scope.showInputbox = function(lblValue)
                        {
                            if(lblValue.indexOf('Questions / Comments') > -1)
                            {
                                return true;
                            }
                        }
                        $scope.showInputboxForResolved = function(lblValue)
                        {
                            if(lblValue.indexOf('Assigned to Commercial Owner (CO) – Awaiting CO Review') > -1)
                            {
                                return true;
                            }
                        }
                        $scope.showInputboxForDenial = function(lblValue)
                        {
                            if(lblValue.indexOf('Potential Denial - Request TP Processor to arrange meeting with IQVIA Legal') > -1)
                            {
                                return true;
                            }
                        }
                        $scope.showInputboxForUnderValidation = function(lblValue)
                        {
                            if(lblValue.indexOf('Under Validation') > -1)
                            {
                                return true;
                            }
                        }
                        
                        $scope.manualreasonsSummaryPopup = function(reason)
                        {
                            $scope.$log.info('TextEditorList: ' + JSON.stringify($scope.TextEditorList));
                            $scope.manualreasonSummaryPopup=true;
                            $scope.$log.info('manualreasonSummaryPopup: ' + $scope.manualreasonSummaryPopup);
                            if($scope.TextEditorList != null){
                                $scope.FilterTextEditorList = {};
                                angular.forEach($scope.TextEditorList, function(value, key) {
                                    $scope.$log.info('key1text'+JSON.stringify(key));
                                    $scope.$log.info('value1text'+JSON.stringify(value));
                                    $scope.$log.info('reason'+JSON.stringify(reason));
                                    if(key.indexOf(reason) != -1 && (key == reason || reason == 'Vendor requires review')&& $scope.TextEditorList[key] != null){
                                        
                                        if(reason == 'Vendor requires review'){
                                            if($scope.vendorchecklist && value.Page_Name__c == 'Vendor requires review Checklist'){
                                                $scope.FilterTextEditorList[key] = value;
                                                $scope.$log.info('vendorchecklistinside');
                                            }
                                            if($scope.newvendorchecklist && value.Page_Name__c == 'Vendor requires review New Vendor'){
                                                $scope.FilterTextEditorList[key] = value;
                                                $scope.$log.info('newvendorchecklistinside');
                                            }
                                            if($scope.vendorpharmachecklist && value.Page_Name__c == 'Vendor requires review Vendor is a Pharma company or Affiliate of client'){
                                                $scope.FilterTextEditorList[key] = value;
                                                $scope.$log.info('vendorpharmachecklistinside');
                                            }
                                            if($scope.vendorlegalfirmchecklist && value.Page_Name__c == 'Vendor requires review Vendor is a Legal Firm'){
                                                $scope.FilterTextEditorList[key] = value;
                                                $scope.$log.info('vendorlegalfirmchecklistinside');
                                            }
                                            if($scope.vendoracademiachecklist && value.Page_Name__c == 'Vendor requires review Vendor is an Educational institution (Academia)'){
                                                $scope.FilterTextEditorList[key] = value;
                                                $scope.$log.info('vendoracademiachecklistinside');
                                            }
                                        }
                                        else if(reason == 'Client and/or Vendor requires offshore approval'){
                                            if($scope.isvalidVendorAccessCountry == true && value.Page_Name__c == 'Client and/or Vendor requires offshore approval Vendor requires offshore access location approval'){
                                                $scope.FilterTextEditorList[key] = value;
                                                $scope.TextEditorReason = value.Content__c.replace("Vendor_Employee_Accessed_Data_in_country__c", $scope.employeeAccessDataCountry);
                                                $scope.FilterTextEditorList[key].Content__c = $scope.TextEditorReason;
                                                $scope.$log.info('vendoroffshoreaccess');
                                            }
                                            if($scope.isvalidVendorStorageCountry == true && value.Page_Name__c == 'Client and/or Vendor requires offshore approval Vendor requires offshore storage location approval'){
                                                
                                                $scope.FilterTextEditorList[key] = value;
                                                $scope.TextEditorReason = value.Content__c.replace("Vendor_Employee_Store_Data_in_country__c", $scope.employeeStoreDataCountry);
                                                $scope.FilterTextEditorList[key].Content__c = $scope.TextEditorReason;
                                                
                                                $scope.$log.info('vendoroffshorestorage');
                                            }
                                            if($scope.isPreAppTech == true && value.Page_Name__c == 'Client and/or Vendor requires offshore approval Offshore technology of other requires AMA review'){
                                                $scope.FilterTextEditorList[key] = value;
                                                $scope.$log.info('vendorpretech');
                                            }
                                            if($scope.isvalidClientStorageCountry == true && value.Page_Name__c == 'Client and/or Vendor requires offshore approval Client requires offshore storage approval'){
                                                $scope.FilterTextEditorList[key] = value;
                                                $scope.$log.info('clientoffshorestorage');
                                            }
                                        }
                                        else if (reason == 'Ex-US legal entity not a foreign affiliate') {
                                            $scope.$log.info('Enter in Ex-US legal entity not a foreign affiliate ');
                                            $scope.FilterTextEditorList[key] = value;
                                            $scope.$log.info('Vendor Legal Name '+$scope.vendorLegalName);
                                            $scope.TextEditorReason = value.Content__c.replace("Vendor_Legal_Name", $scope.vendorLegalName);
                                            $scope.FilterTextEditorList[key].Content__c = $scope.TextEditorReason;
                                            $scope.$log.info('Vendor Legal Name '+$scope.vendorLegalName);
                                        }
                                        else if(reason == 'Client does not have an AMA agreement'){
		                                    $scope.FilterTextEditorList[key] = value;
	                                        $scope.TextEditorReason = value.Content__c.replace('AMACCLDATE', $scope.latestAMAContractDate);
	                                        $scope.FilterTextEditorList[key].Content__c = $scope.TextEditorReason;                                    
                                        }
                                        else if(reason != 'Vendor requires review' || reason != 'Client and/or Vendor requires offshore approval'){
                                            $scope.FilterTextEditorList[key] = value;
                                        }
                                        
                                        $scope.$log.info('reason2'+JSON.stringify(value.English_Translation__c));
                                        $scope.TextEditorReason = value.English_Translation__c;
                                        
                                    }
                                });
                            }
                            //$scope.manualreasonSummaryPopup = false;
                            $scope.$log.info('$scope.FilterTextEditorList'+JSON.stringify($scope.FilterTextEditorList));
                        }
                        $scope.changeActionForAll = function(lblValue,tableType)
                        {
                            $scope.$log.info('inside changeActionForAll'+JSON.stringify(lblValue));
                            $scope.$log.info('inside SelectedComReviewListArray'+JSON.stringify($scope.SelectedComReviewListArray));
                            if(tableType != 'addTermTable'){
                                let index = 0;
                                angular.forEach($scope.SelectedComReviewListArray, function(value, key) {
                                    if(index < $scope.currentIndex || index > ($scope.currentIndex + $scope.pageSize)){
                                        index += 1;
                                        return;
                                    }
                                    index += 1;
                                    $scope.$log.info('inside SelectedComReviewListArrayvalue'+JSON.stringify($scope.SelectedComReviewListArray[key].action));
                                    if(($scope.SelectedComReviewListArray[key].reason != 'Other Use Selected' && $scope.SelectedComReviewListArray[key].reason != 'Other Offering Selected' && ($scope.viewMode.indexOf('TPSubmit') != -1 || $scope.viewMode.indexOf('TPUS') != -1)) || ($scope.viewMode.indexOf('CSubmit') != -1 || $scope.viewMode.indexOf('MGMT') != -1 || $scope.viewMode.indexOf('LGL') != -1 || $scope.viewMode.indexOf('AMAAdmin') != -1) || $scope.otherReasonAvailable == true) {
                                        $scope.SelectedComReviewListArray[key].action = lblValue;
                                    }
                                    $scope.$log.info('after SelectedComReviewListArrayvalue'+JSON.stringify($scope.SelectedComReviewListArray[key].action));
                                });
                            }  
                            else{    
                                angular.forEach($scope.tpProAddTermReviews, function(value, key) {
                                    $scope.tpProAddTermReviews[key].action = lblValue;
                                });
                            }
                        }
                        
						$scope.showCheckBox = function(lblValue)
                        {
							if(lblValue.indexOf('Executed New') > -1)
                            {
                                return false;
                            }
                            return true;
                        }
                        
                        $scope.showCheckBoxForRenew = function(lblValue){
							if(lblValue.indexOf('Executed New') > -1)
                            {
                                return true;
                            }                        
                        }

                        $scope.popupConfirm = function(msg, truePart, falsePart, isYesNo)
                        {
                            if(isYesNo)
                                popup(msg, {'verify':true, 'animate':true}, function(r)
                                {
                                    if(r)
                                        truePart();
                                    else
                                        falsePart();
                                    haltScreen = false;
                                    $scope.applyChanges();
                                });
                            else
                                popup(msg, {'confirm':true, 'animate':true}, function(r)
                                {
                                    if(r)
                                        truePart();
                                    else
                                        falsePart();
                                    haltScreen = false;
                                    $scope.applyChanges();
                                });
                            $('.aButtons button').each(function(){
                                if($(this).attr('value') == 'cancel')
                                    $(this).html('{!$Label.TPA_Return}');
                                if($(this).attr('value') == 'ok')
                                    $(this).html('{!$Label.TPA_OK}');
                            });
                        }
                        //****** Utility Events End ******//
                        $scope.loadForm();
                    }]);
                    <!-- Page Controller End -->

                //****** Controller directives Start ******//
                //*** directive to show confirm box ***//
                myapp.directive('ngConfirmClick', [
                    function(){
                        return {
                            link: function (scope, element, attr) {
                                var msg = attr.ngConfirmClick || "{!$Label.TPA_Are_you_sure}?";
                                var clickAction = attr.confirmedClick;
                                element.bind('click',function (event) {
                                    popup(msg, {'verify':true, 'animate':true}, function(r)
                                    {
                                        if(r) {
                                            scope.$eval(clickAction);
                                        }
                                    });
                                });
                            }
                        };
                    }]);
                    
                    //Shut down popup code
                    var popupAlert = function(msg, truePart)
                    {
                    popup(msg, {'animate':true}, 
                    function(r)
                    {
                        if(r && truePart != null)
                            truePart();                    
                    });
                    //  $(".aButtons button").html('{!$Label.TPA_OK}');
                    }
                    
                    //****** Controller directives End ******//

                    //*** function to Load Bootstrap Balloon tool tip Start ***//
                    function applyBootstrapTooltip(pos, cssName)
                    {
                        $(cssName).tooltip({
                                placement : pos,
                                html : true
                            });
                    }
                    //*** function to Load Bootstrap Balloon tool tip End ***//

                    //*** function to read Query strings Start ***//
                    function getParameterByName(name)
                    {
                        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
                        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"), results = regex.exec(location.search);
                        return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " ")) ;
                    }
                    //*** function to read Query strings End ***//

                    function onActionClick()
                    {
                        showLoading();
                    }

                    var childWindow;
                    var winClosed;
                    //*** function disables parent window when child window opens Start ***//
                    function parent_disable()
                    {
                        if(childWindow != null && !childWindow.closed)
                        {
                            childWindow.focus();
                            return false;
                        }
                        return true;
                    }
                    //*** function disables parent window when child window opens End ***//

                    $(document).ready(function() {

                        $('.sfdcBody').focus(parent_disable);
                        $('.sfdcBody').click(parent_disable);

                        //*** Bootstrap Tooltip Load Script Start ***//
                        applyBootstrapTooltip('right', '.rightTooltip');
                        applyBootstrapTooltip('top', '.topTooltip');
                        applyBootstrapTooltip('bottom', '.bottomTooltip');
                        //*** Bootstrap Tooltip Load Script End ***//
                    });
                </script>
                    <!-- ****** AngularJS script End ****** -->

                <style type="text/css">

                    /**** Common Page Style Start ****/
                    .list {width:100%;border: 1px solid #e0e3e5;}

                    tr.headerRow th{background: none repeat scroll 0 0 #f2f3f3;color:#333;}
                    tr.dataRow td:hover{background-color:#e3f3ff;}
                    tr.dataRow td a{color:#333;}

                    .helpOrb:hover
                    {
                        background-position: right top;
                    }
                    .imsheader
                    {
                        bgcolor: #1793EC !important;
                        color: #000 !important;
                    }

                    .bPageBlock.apexDefaultPageBlock .pbBody .pbSubheader h3
                    {
                    color: #000 !important;
                    }
                    .labelDiv
                    {
                        float:left;
                        width:30%;
                        word-wrap: break-word;
                    }

                    .valueDiv
                    {
                        margin-right:5%;
                        float:right;
                        width:50%;
                        position:relative;
                        display:inline;
                    }

                    h1, h2, h3, h4, h5, h6
                    {
                        font-weight: bold;
                    }

                    .detailList .labelCol
                    {
                        width:18%;
                    }

                    .lbl
                    {
                        color:#4a4a56;
                        font-size: 12px;
                        text-align:justify;
                    }

                    .bPageBlock, .brdPalette
                    {
                        border-top-color: #10a6f0 !important;
                    }

                    .zen-mbm, .menuButtonRounded, .pageMsg
                    {
                        font-size: 12px !important;
                    }

                    .messageTable, .panelText, .message
                    {
                        font-size: 12px !important;
                        margin-top:5px !important;
                    }

                    label, .labelCol, .data2Col, .btn, .dataCol
                    {
                        font-size: 12px !important;
                        color: #4a4a56 !important;
                    }

                    .pbSubheader
                    {
                        font-size:12px !important;
                        padding:4px 16px !important;
                    }

                    .pbHeader
                    {
                        display:none !important;
                    }

                    .pbBody
                    {
                        margin-top:0px !important;
                    }

                    *,.noOutline
                    {
                        outline:none !important;
                    }

                    .tooltip-inner
                    {
                        min-width:100px;
                        max-width:400px;
                        white-space:pre-wrap;
                        text-align:left;
                    }

                    .modal-dialog
                    {
                        margin: 10% auto;
                    }

                    
                    
                    .slds-modal__container {
                        width: 100% !important;
                        max-width: 75rem !important;
                    }
                    .slds-modal__content {
                    	position: relative;
                    	padding: 10px;
                    	overflow: auto !important;
                    	word-wrap: break-all !important;
                    }

                    .select2-results li
                    {
                        margin-left:0px;
                    }

                    .select2-highlighted
                    {
                        color: #000 !important;
                        background-color:#ccc !important;
                    }
                    
                    .sortingHighlighter 
                    {
                        background-image:linear-gradient(to bottom,#F0F6F2,#FBFDFC);
                    	color:#000000 !important;
                    	font-weight:bold;
                    	border-left: 2px solid #ccc !important;
                    	border-right: 2px solid #ccc !important;
                    }
                    
                    .sortingHighlighterForIcon 
                    {
                        background-image:linear-gradient(to bottom,#F0F6F2,#FBFDFC);
                        color:#000000 !important;
                        font-weight:bold;
                    }

                    .select2-search-field input
                    {
                        padding: 2px 5px !important;
                    }
                    /**** Common Page Style End ****/

                    /**** Error Message Style Start ****/
                    .message .messageText h4
                    {
                        font-size:13px;
                        margin-left: 30px;
                        margin-top: 0px;
                    }
                    
                    ul li{
                    	font-size:13px;
                    }

                    .message ul li
                    {
                        list-style:disc;
                    }

                    .message ul
                    {
                        margin-left: 40px;
                        margin-top: 20px;
                    }
                    div.textEditorContent td {
                    	white-space: normal !important;
                    }
                    .displayTable th {
                    	white-space: normal !important;
                    }
                    .displayTable td {
                    	white-space: normal !important;
                    }
                    /**** Error Message Style End ****/
                </style>
            </head>
            <body id="pageBody" oncontextmenu="return false;" style="background-image: url(/_slds/images/themes/lightning_blue/lightning_blue_background.png),linear-gradient(to top, rgba(160, 180, 206, 0.0) 0, rgba(160, 180, 206, 1.0)); background-repeat: no-repeat; min-height: 100vh">
                <div id="backWhiteOverlay" style="position:absolute;z-index:10000 !important;width:100%;height:100%;display:none;"></div>
                <apex:form html-class="slds-form slds-form_horizontal">
                    <div id="ng-app" class="slds-p-around_small slds-m-around_small" ng-app="TpaAccessRequest" style="background-color:white">
                        <div id="controllerPage" ng-controller="controllerPage">
                            <c:VFC_TPA_LoadingImage />
                            <!-- Error Message Box Start -->
                                <div ng-show="isError" class="slds-theme_error" role="alert" style="display:none;">
                                    <div class="message errorM3 slds-notify__content " role="alert">
                                        <div class="slds-grid slds-grid_vertical slds-size_1-of-1 slds-p-around_small">
                                            <div class="slds-col">
                                                <div class="slds-grid">
                                                    <div class="slds-col slds-size_1-of-3"></div>
                                                    <div class="slds-col slds-size_1-of-3">
                                                        <h2 class="slds-text-heading_small">
                                                            <div class="messageText">
                                                                <span><h4>Error</h4></span>
                                                            </div>
                                                        </h2>
                                                    </div>
                                                    <div class="slds-col slds-size_1-of-3"></div>
                                                </div>
                                            </div>
                                            <div class="slds-col">
                                                <div class="slds-grid">
                                                    <div class="slds-col slds-size_1-of-5"></div>
                                                    <div class="slds-col slds-size_1-of-5"></div>
                                                    <div class="slds-col slds-size_1-of-5">
                                                        <span ng-bind-html-unsafe="errorMsg"></span>
                                                    </div>
                                                    <div class="slds-col slds-size_1-of-5"></div>
                                                    <div class="slds-col slds-size_1-of-5"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Error Message Box End -->
                            <div class="slds-form" role="list">
                                <h3 class="slds-section__title slds-theme_shade slds-p-left_small">
                                    <span class="slds-truncate" title="{{thirdPartyAccessProgramTPANumber}}"><b>{{thirdPartyAccessProgramTPANumber}}</b></span>
                                </h3>
                                <div class="slds-form-element slds-form-element_horizontal">
                                    <div class="slds-form-element slds-form-element_horizontal" ng-show="tpaObj.parentRequestName != null && tpaObj.parentRequestRenewed && tpaObj.parentRequestRenewedAs == tpaObj.requestId">
                                        <label ><b><span style="color: #0000FF;">Step 1 – Review TPA Request Details:</span> This is a renewal TPA. Parent TPA is {{tpaObj.parentRequestName}} </b></label>
                                        <!--<label ><b><span >{{tpaObj.requestName}} Review TPA Request Details: This is a renewal TPA. Parent TPA is {{tpaObj.parentRequestName}}</span> </b></label>-->
                                    </div>
                                    <div class="slds-form-element slds-form-element_horizontal" ng-show="tpaObj.parentRequestName == null || (tpaObj.parentRequestName != null && !tpaObj.parentRequestRenewed)">
                                        <label ><b><span style="color: #0000FF;">Step 1 – Review TPA Request Details:</span></b></label>
                                        <!--<label ><b><span >{{tpaObj.requestName}} Review TPA Request Details: </span> </b></label>-->
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label"><b>Client Company:</b></label>
                                            <div class="slds-form-element__control">
                                                <span >{{tpaObj.clientName}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label" for=""></label>
                                            <div class="slds-form-element__control">
                                                <span ></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label"><b>Status:</b></label>
                                            <div class="slds-form-element__control">
                                                <span >{{tpaObj.requestStatus}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label" for=""></label>
                                            <div class="slds-form-element__control">
                                                <span ></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label"><b>Third Party Company: </b></label>
                                            <div class="slds-form-element__control">
                                                <span >{{tpaObj.vendorName}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label" for=""></label>
                                            <div class="slds-form-element__control">
                                                <span ></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row" ng-show="tpaObj.website != null">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label"><b>{!$Label.TPA_Vendor_Website_Network_Id}</b></label>
                                            <div class="slds-form-element__control">
                                                <span >{{tpaObj.website}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label" for=""></label>
                                            <div class="slds-form-element__control">
                                                <span ></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label"><b>Client Project Name: </b></label>
                                            <div class="slds-form-element__control">
                                                <span >{{tpaObj.clientProjectName}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label" for=""></label>
                                            <div class="slds-form-element__control">
                                                <span ></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label"><b>Agreement Start and End Dates: </b></label>
                                            <div class="slds-form-element__control">
                                                <span >{{tpaObj.dataAccessStartDate}}, {{tpaObj.dataAccessEndDate}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label" for=""></label>
                                            <div class="slds-form-element__control">
                                                <span ></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row" ng-show="tpaObj.dataPeriodStartDate != null && tpaObj.dataPeriodEndDate != null ">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label"><b>Data Period Start and End Dates*: </b></label>
                                            <div class="slds-form-element__control">
                                                <span >{{tpaObj.dataPeriodStartDate}}, {{tpaObj.dataPeriodEndDate}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label" for=""></label>
                                            <div class="slds-form-element__control">
                                                <span ></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class = "slds-p-around_xx-small" style="font-size: 9px;" ng-show="tpaObj.dataPeriodStartDate != null && tpaObj.dataPeriodEndDate != null ">* Note: {!$Label.TPA_Commercial_Review_Mail_DPED_Note}</div>
                                <!-- <div class="slds-form__row" ng-show="amaLicenseRequired != '' ">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label"><b>AMA license required: </b></label>
                                            <div class="slds-form-element__control">
                                                <span >{!amaLicenseRequired}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal">
                                            <label class="slds-form-element__label" for=""></label>
                                            <div class="slds-form-element__control">
                                                <span ></span>
                                            </div>
                                        </div>
                                    </div>
                                </div> -->
                                
                                <div class="slds-form-element slds-form-element_horizontal" ng-show="isUseTermsTabVisible == true">
                                    <label ><b> Use Specific Additional Term that will be included in the TPA Agreement: </b></label>
                                    
                                    <table class="detailList" border="0" cellpadding="0" cellspacing="0">
                                        <tbody>
                                            <tr ng-repeat="(k,v) in useAddocAdditionalTerms">
                                                <td class="data2Col first last " colspan="2" style="white-space: normal;"><br />
                                                    <b><u><div><span style="color: #000000;" ng-bind-html-unsafe="v.Term_Name__c" class="ng-binding textEditorContent"></span>:</div></u></b>
                                                    <div style="color: #000000;" ng-bind-html-unsafe="v.Addtional_Term__c" class="ng-binding textEditorContent"></div>
                                                   
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                </div>
                                
                                <div class="slds-form-element slds-form-element_horizontal" ng-show="isUseOfferingTermsTabVisible == true">
                                    <label ><b> Use/Offering Specific Additional Term that will be included in the TPA Agreement: </b></label>
                                    
                                    <table class="detailList" border="0" cellpadding="0" cellspacing="0">
                                        <tbody>
                                            <tr ng-repeat="(k,v) in useOfferingAddocAdditionalTerms">
                                                <td class="data2Col first last " colspan="2" style="white-space: normal;"><br />
                                                    <b><u><div><span style="color: #000000;" ng-bind-html-unsafe="v.Term_Name__c" class="ng-binding textEditorContent"></span>:</div></u></b>
                                                    <div style="color: #000000;" ng-bind-html-unsafe="v.Addtional_Term__c" class="ng-binding textEditorContent"></div>
                                                   
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                </div>
                              
                                <div class="slds-form-element slds-form-element_horizontal" ng-show="isOfferingTermsTabVisible == true">
                                    <label ><b> Offering Specific Additional Term that will be included in the TPA Agreement: </b></label>
                                    <table class="detailList" border="0" cellpadding="0" cellspacing="0">
                                        <tbody>
                                            <tr ng-repeat="(k,v) in TextAdditionalTerms track by $index">
                                                <td class="data2Col first last " colspan="2" style="white-space: normal;"><br />
                                                    <div style="color: #000000;" ng-bind-html-unsafe="v.Content__c" class="ng-binding textEditorContent"></div>
                                                    
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table class="detailList" border="0" cellpadding="0" cellspacing="0">
                                        <tbody>
                                            <tr ng-repeat="(k,v) in TpaAdditionalTerms">
                                                <td class="data2Col first last " colspan="2" style="white-space: normal;"><br />
                                                    <b><u><div><span style="color: #000000;" ng-bind-html-unsafe="v.Term_Name__c" class="ng-binding textEditorContent"></span>:</div></u></b>
                                                    <div style="color: #000000;" ng-bind-html-unsafe="v.Addtional_Term__c" class="ng-binding textEditorContent"></div>
                                                   
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table class="detailList" border="0" cellpadding="0" cellspacing="0">
                                        <tbody>
                                            <tr ng-repeat="(k,v) in TpaDynamicNotifications">
                                                <td class="data2Col first last " colspan="2" style="white-space: normal;"><br/>
                                                    <div style="color: #000000;" ng-bind-html-unsafe="v.Offering_Notifications__r.Content__c" class="ng-binding textEditorContent"></div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div class="slds-section slds-is-open">
                                <!--<h3 class="slds-section__title slds-theme_shade slds-p-left_small">
                                    <span class="slds-truncate" title="{!$Label.TPA_Commercial_Reviews}"><b>{!$Label.TPA_Commercial_Reviews}</b></span>
                                </h3>-->
                                <div class="slds-form-element slds-form-element_horizontal">
                                    <label ><b><span style="color: #0000FF;">Step 2 – Review Manual Trigger(s) for Decision: </span> Please review and respond to each ‘Manual Review Reason’.  You may also select a single decision to apply to all by clicking under ‘Same Decision for All’ and if you need to change one decision for a specific combination, go to that combination and edit your decision. </b></label>
                                    <!--<label ><b><span >{{tpaObj.requestName}} Review TPA Request Details: </span> </b></label>-->
                                </div>
                                <div style= "font-weight: 500;">
                                    <label>
                                        <a href="{!permittedUseDefSummary}" style ="text-decoration: underline;" target="_blank" >Click Here to Review Permitted Use Definitions</a>
                                        <span>
                                            for associated Authorized / Non-Authorized Activities
                                        </span>
                                    </label>
                                </div>
                                <div aria-hidden="false" class="slds-section__content" ng-show="SelectedComReviewListArray.length > 0">
                                    <div role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" ng-hide="!manualreasonSummaryPopup" style="display:none;">
                                        <div class="slds-modal__container" style="z-index: 1">
                                            <header class="slds-modal__header">
                                                <h2 class="slds-text-heading_medium slds-hyphenate">
                                                </h2>
                                            </header>
                                            <div class="slds-modal__content slds-p-around_medium slds-text-align_justify" id="modal-content-id-1" >
                                                <table class="detailList" border="0" cellpadding="0" cellspacing="0">
                                                    <tbody>
                                                        <tr ng-repeat="(k,v) in FilterTextEditorList">
                                                            <td class="data2Col first last " colspan="2" style="white-space: normal;">
                                                                <div style="color: #000000;" ng-bind-html-unsafe="v.Content__c" class="ng-binding textEditorContent"></div>
                                                                <br />
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--<apex:outputText value="{!Message}" escape="false" />
                                                <apex:outputText value="{{TextEditorReason}}" escape="false" />-->
                                            </div>
                                            <footer class="slds-modal__footer">
                                                <div class="slds-text-align_center slds-m-top_x-small slds-m-bottom_x-small">
                                                    <button class="slds-button slds-button_outline-brand" onclick="return false;" ng-click="manualreasonSummaryPopup=false;">{!$Label.TPA_OK}</button>
                                                </div>
                                            </footer>
                                        </div>
                                        <div class="slds-backdrop slds-backdrop_open" style="z-index: 0"></div>
                                    </div>
                                    <table class="displayTable list slds-table slds-table_bordered slds-table_col-bordered">
                                        <tr class="headerRow">
                                            <th scope="col" ng-click="sortOrderChangeHeaderClick('reason', 'Reason');"><span>{!$Label.TPA_Manual_Review_Reason}<span ng-bind-html-unsafe="ascImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='ascReason','':sortOrder=='descReason'}"></span><span ng-bind-html-unsafe="descImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='descReason','':sortOrder=='ascReason'}"></span></span>
                                                <div style="margin: auto;">
                                                    <span style="color: #00b0f0;font-size:12px;margin: auto;"><b>[Click Below for Guidance]</b></span>
                                                </div>
                                            </th>
											
                                            <th scope="col" ng-click="sortOrderChangeHeaderClick('offering', 'Offering');"><span><span ng-if="viewModeAddTerm">TPA Additional Term Name</span><span ng-if="!viewModeAddTerm">{!$Label.TPA_Associated_Offering_to_Review}</span><span ng-bind-html-unsafe="ascImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='ascOffering','':sortOrder=='descOffering'}"></span><span ng-bind-html-unsafe="descImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='descOffering','':sortOrder=='ascOffering'}"></span></span></th>
                                            <th scope="col" ng-click="sortOrderChangeHeaderClick('useCategory', 'UseCategory');"><span><span ng-if="viewModeAddTerm">TPA Additional Term Category</span><span ng-if="!viewModeAddTerm">{!$Label.TPA_Associated_Offering_s_Use_Category_s}</span><span ng-bind-html-unsafe="ascImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='ascUseCategory','':sortOrder=='descUseCategory'}"></span><span ng-bind-html-unsafe="descImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='descUseCategory','':sortOrder=='ascUseCategory'}"></span></span></th>
                                            <th scope="col" ng-click="sortOrderChangeHeaderClick('use', 'Use');"><span><span ng-if="viewModeAddTerm">TPA Additional Term</span><span ng-if="!viewModeAddTerm">{!$Label.TPA_Associated_Offering_s_Use_s_Requested}</span><span ng-bind-html-unsafe="ascImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='ascUse','':sortOrder=='descUse'}"></span><span ng-bind-html-unsafe="descImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='descUse','':sortOrder=='ascUse'}"></span></span></th>
                                            <th scope="col" ng-if="viewModeAddTerm" ><span>Ad-hoc Exhibit / Schedule Page</span></th>
                                            <th scope="col" ng-click="sortOrderChangeHeaderClick('bu', 'bu');" ng-if="!viewModeAddTerm"><span><span>Country Of Offering</span><span ng-bind-html-unsafe="ascImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='ascUse','':sortOrder=='descUse'}"></span><span ng-bind-html-unsafe="descImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='descUse','':sortOrder=='ascUse'}"></span></span></th>
                                            <th><span ng-if="viewMode == 'CSubmit'">{!$Label.TPA_Commercial_Owner_Decision}</span><span ng-if="viewMode.indexOf('MGMT') != -1 || viewMode == 'SCSubmit'">Management Reviewer Decision</span>
                                                <span ng-if="viewMode.indexOf('LGL') != -1 || viewMode == 'LGL'">Legal Reviewer Decision</span>
                                                <div style="margin: auto;">
                                                    <label class="slds-form-element__label">
                                                        <abbr class="slds-required" title="required"></abbr><b>{!$Label.TPA_Same_Decision_for_All}</b>
                                                    </label>
                                                    <div id="opPanel" class="slds-form-element__control">
                                                        <div>
                                                            <select class="slds-select" id="ddRegion" ng-model="overallAction"  ng-options="v.lblVal as v.lbl for v in vendorActionList" ng-change="changeActionForAll(overallAction,'')">
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </th>
                                            <th ng-if="viewMode.indexOf('CSubmit') != -1 || viewMode.indexOf('MGMT') != -1"><span ng-if="viewMode == 'CSubmit'">Commercial Owner Name</span><span ng-if="viewMode.indexOf('MGMT') != -1 || viewMode == 'SCSubmit'">Management Reviewer Name</span></th>
                                            <th>{!$Label.TPA_Date_of_Review}</th>
                                        </tr>
                                        <tr class="dataRow" ng-repeat="(k,v) in SelectedComReviewListArray | myLimitTo : pageSize : currentIndex | orderBy:columnSortBy:isDescending " onfocus="if (window.hiOn){hiOn(this);}" onblur="if (window.hiOff){hiOff(this);}" onmouseout="if (window.hiOff){hiOff(this);} " onmouseover="if (window.hiOn){hiOn(this);} ">
                                            <td class="dataCell" ng-class="{'sortingHighlighter':columnSortBy=='reason','':columnSortBy!='reason'}">
                                                <a href="javascript:void(0);" style="text-decoration:underline;" ng-click="manualreasonSummaryPopup=true;manualreasonsSummaryPopup(v.reason);">{{v.reason}}</a>
                                                <!--<c:VFC_TPA_LightningHelpText cHlpTxt="{!Message}"/>-->
                                            </td>
                                            
                                            <td class="dataCell" ng-class="{'sortingHighlighter':columnSortBy=='offering','':columnSortBy!='offering'}">
                                                {{viewModeAddTerm ? v.additionalTermName : v.offering}}
                                            </td>
                                            <td class="dataCell" ng-class="{'sortingHighlighter':columnSortBy=='useCategory','':columnSortBy!='useCategory'}">
                                                {{viewModeAddTerm ? v.additionalTermCategory : v.useCategory}}
                                            </td>
                                            <td class="dataCell" ng-class="{'sortingHighlighter':columnSortBy=='use','':columnSortBy!='use'}">
                                                {{viewModeAddTerm ? v.additionalTerm : v.use}}
                                            </td>
											<td ng-if="viewModeAddTerm" class="dataCell" >
                                                <span ng-if="v.attachment == null || v.attachment == ''">N/A</span><span ng-if="v.attachment != null && v.attachment != ''"><a href="/servlet/servlet.FileDownload?file={{v.attachment}}" target="_blank" >Click to View</a></span>  
                                            </td>
											<td ng-if="!viewModeAddTerm" class="dataCell" ng-class="{'sortingHighlighter':columnSortBy=='bu','':columnSortBy!='bu'}">
                                                {{v.bu}}
                                            </td>
                                            <td class="dataCell">
                                                <div id="opPanel" class="slds-form-element__control">
                                                    <div ng-if="!v.reason.includes('Vendor - Use - Offering Secondary Review by') && !v.reason.includes('Vendor - Use Secondary Review by')">
                                                        <select ng-if="((v.reason != 'Other Use Selected' && v.reason != 'Other Offering Selected') && (viewMode == 'TPSubmit' || viewMode == 'TPUS')) || viewModeAddTerm || (viewMode.indexOf('CSubmit') != -1 || viewMode.indexOf('MGMT') != -1 || viewMode.indexOf('AMAAdmin')  != -1)" class="slds-select" id="ddRegion" ng-model="v.action" ng-init="v.action" ng-options="v.lblVal as v.lbl for v in vendorActionList" >
                                                            </select>
                                                            <select ng-if="(v.reason == 'Other Use Selected' || v.reason == 'Other Offering Selected') && (viewMode == 'TPSubmit' || viewMode == 'TPUS')" class="slds-select" id="ddRegion" ng-model="v.action" ng-init="v.action" ng-options="v.lblVal as v.lbl for v in vendorOtherActionList" >
                                                            </select>
                                                        </div>
                                                        <div ng-if="v.reason.includes('Vendor - Use - Offering Secondary Review by') || v.reason.includes('Vendor - Use Secondary Review by')">
                                                            <select class="slds-select" id="ddRegion" ng-model="v.action" ng-init="v.action" ng-options="v.lblVal as v.lbl for v in vendorActionListForSecReview" >
                                                            </select>
                                                        </div>
                                                        <div class="requiredInput">
                                                            <div class="requiredBlock"></div>
                                                            <input class="slds-input" type="text area" maxlength="1000" id="reqNo" placeholder="{!$Label.TPA_Additional_Questions_For_TP_Processor}" 
                                                                ng-show="showInputbox(v.action) || (v.actionvalue != '' && v.action == 'Questions / Comments' && (viewMode.indexOf('CSubmit') != -1 || viewMode=='TPSubmit'))" ng-model = "v.actionvalue" 
                                                                ng-class="{'errStyle':v.isQuestionsCommentsError,'':!v.isQuestionsCommentsError}"/>
                                                        </div>
                                                    	<div class="requiredInput">
                                                            <div class="requiredBlock"></div>
                                                            <input class="slds-input" type="text area" maxlength="1000" id="reqNo" placeholder="Add Commercial Owner Email Here" 
                                                                ng-show="showInputboxForResolved(v.action) || (v.actionvalue2 != '' && v.action == 'Assigned to Commercial Owner (CO) – Awaiting CO Review' && (viewMode.indexOf('TPSubmit') != -1 || viewMode =='TPSubmit'))" ng-model = "v.actionvalue2" 
                                                                ng-class="{'errStyle':v.isResolvedEmailError,'':!v.isResolvedEmailError}"/>
                                                        </div>
                                                    	<div class="requiredInput">
                                                            <div class="requiredBlock"></div>
                                                            <input class="slds-input" type="text area" maxlength="1000" id="reqNo" placeholder="{!$Label.TPA_Additional_Text_for_Potential_Denial}" 
                                                                ng-show="showInputboxForDenial(v.action) || (v.actionvalue3 != '' && v.action == 'Potential Denial - Request TP Processor to arrange meeting with IQVIA Legal' && (viewMode.indexOf('CSubmit') != -1 || viewMode=='TPSubmit'))" ng-model = "v.actionvalue3" 
                                                                ng-class="{'errStyle':v.isPotentialDenialTextError,'':!v.isPotentialDenialTextError}"/>
                                                        </div>
														<div class="requiredInput">
                                                            <div class="requiredBlock"></div>
                                                            <input class="slds-input"  type="text area" maxlength="1000" id="reqNo" placeholder="{!$Label.TPA_Comment_For_What_Is_Under_Validation}" 
                                                                ng-show="showInputboxForUnderValidation(v.action) || (v.actionvalue4 != '' && v.action == 'Under Validation' && (viewMode.indexOf('TPSubmit') != -1 || viewMode=='CSubmit'))" ng-model = "v.actionvalue4" 
                                                                ng-class="{'errStyle':v.isUnderValidationTextError,'':!v.isUnderValidationTextError}"/>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <div class="requiredBlock"></div>
                                                        <select class="slds-select" ng-show="v.action != '--None--' && v.action != 'Questions / Comments' && v.action != 'Potential Denial - Request TP Processor to arrange meeting with IQVIA Legal' && v.legalEntityPresent == false && viewMode.indexOf('CSubmit') != -1" id="ddlegalEntity" ng-model="v.selLegalEntity" ng-options="v for v in legalEntityListforOther" >
                                                        </select>
                                                    </div> 
                                            </td>
                                            <td ng-if="viewMode.indexOf('CSubmit') != -1 || viewMode.indexOf('MGMT') != -1" class="dataCell">
                                                <span> {{v.commownername}} </span>
                                            </td>
                                            <td class="dataCell">
                                                <span> {{v.reviewdate}} </span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th scope="col" class="slds-size--1-of-5 td-fixed-width" style ="text-align:center; border: 2px solid rgb(211,211,211);">
                                                <button class="slds-button slds-button_brand" ng-click="prevReviewsPage()" ng-disabled="currentPageNo <= 1" onclick="return false;">Prev</button>
                                                Page {{currentPageNo}} of {{totalPages}}
                                                <button class="slds-button slds-button_brand" ng-click="nextReviewsPage()" ng-disabled="currentPageNo >= totalPages" onclick="return false;">Next</button>
                                            </th>
                                            <th colspan="7"></th>
                                        </tr>
                                    </table>
                                </div>

                                <div aria-hidden="false" class="slds-section__content" ng-show="addHocReviewTP">
                                    <div role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" ng-hide="!manualreasonSummaryPopup" style="display:none;">
                                        <div class="slds-modal__container" style="z-index: 1">
                                            <header class="slds-modal__header">
                                                <h2 class="slds-text-heading_medium slds-hyphenate">
                                                </h2>
                                            </header>
                                            <div class="slds-modal__content slds-p-around_medium slds-text-align_justify" id="modal-content-id-1" >
                                                <table class="detailList" border="0" cellpadding="0" cellspacing="0">
                                                    <tbody>
                                                        <tr ng-repeat="(k,v) in FilterTextEditorList">
                                                            <td class="data2Col first last " colspan="2" style="white-space: normal;">
                                                                <div style="color: #000000;" ng-bind-html-unsafe="v.Content__c" class="ng-binding textEditorContent"></div>
                                                                <br />
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <!--<apex:outputText value="{!Message}" escape="false" />
                                                <apex:outputText value="{{TextEditorReason}}" escape="false" />-->
                                            </div>
                                            <footer class="slds-modal__footer">
                                                <div class="slds-text-align_center slds-m-top_x-small slds-m-bottom_x-small">
                                                    <button class="slds-button slds-button_outline-brand" onclick="return false;" ng-click="manualreasonSummaryPopup=false;">{!$Label.TPA_OK}</button>
                                                </div>
                                            </footer>
                                        </div>
                                        <div class="slds-backdrop slds-backdrop_open" style="z-index: 0"></div>
                                    </div>
                                    <table class="displayTable list slds-table slds-table_bordered slds-table_col-bordered">
                                        <tr class="headerRow">
                                            <th scope="col" ng-click="sortOrderChangeHeaderClick('reason', 'Reason');"><span>{!$Label.TPA_Manual_Review_Reason}<span ng-bind-html-unsafe="ascImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='ascReason','':sortOrder=='descReason'}"></span><span ng-bind-html-unsafe="descImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='descReason','':sortOrder=='ascReason'}"></span></span>
                                                <div style="margin: auto;">
                                                    <span style="color: #00b0f0;font-size:12px;margin: auto;"><b>[Click Below for Guidance]</b></span>
                                                </div>
                                            </th>
											
                                            <th scope="col" ng-click="sortOrderChangeHeaderClick('additionalTermName', 'AdditionalTermName');"><span>TPA Additional Term Name<span ng-bind-html-unsafe="ascImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='ascOffering','':sortOrder=='descOffering'}"></span><span ng-bind-html-unsafe="descImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='descOffering','':sortOrder=='ascOffering'}"></span></span></th>
                                            <th scope="col" ng-click="sortOrderChangeHeaderClick('additionalTermCategory', 'AdditionalTermCategory');"><span>TPA Additional Term Category<span ng-bind-html-unsafe="ascImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='ascUseCategory','':sortOrder=='descUseCategory'}"></span><span ng-bind-html-unsafe="descImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='descUseCategory','':sortOrder=='ascUseCategory'}"></span></span></th>
                                            <th scope="col" ng-click="sortOrderChangeHeaderClick('additionalTerm', 'AdditionalTerm');"><span>TPA Additional Term<span ng-bind-html-unsafe="ascImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='ascUse','':sortOrder=='descUse'}"></span><span ng-bind-html-unsafe="descImage" ng-class="{'sortingHighlighterForIcon':sortOrder=='descUse','':sortOrder=='ascUse'}"></span></span></th>
                                            <th scope="col" ><span>Ad-hoc Exhibit / Schedule Page</span></th>
                                            <th><span>Reviewer Decision</span>
                                                <div style="margin: auto;">
                                                    <label class="slds-form-element__label">
                                                        <abbr class="slds-required" title="required"></abbr><b>{!$Label.TPA_Same_Decision_for_All}</b>
                                                    </label>
                                                    <div id="opPanel" class="slds-form-element__control">
                                                        <div>
                                                            <select class="slds-select" id="ddRegion" ng-model="overallAction"  ng-options="v.lblVal as v.lbl for v in tpProAddTermAction" ng-change="changeActionForAll(overallAction,'addTermTable')">
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </th>
                                            <th>{!$Label.TPA_Date_of_Review}</th>
                                        </tr>
                                        <tr class="dataRow" ng-repeat="(k,v) in tpProAddTermReviews | orderBy:columnSortBy:isDescending" onfocus="if (window.hiOn){hiOn(this);}" onblur="if (window.hiOff){hiOff(this);}" onmouseout="if (window.hiOff){hiOff(this);} " onmouseover="if (window.hiOn){hiOn(this);} ">
                                            <td class="dataCell" ng-class="{'sortingHighlighter':columnSortBy=='reason','':columnSortBy!='reason'}">
                                                <a href="javascript:void(0);" style="text-decoration:underline;" ng-click="manualreasonSummaryPopup=true;manualreasonsSummaryPopup(v.reason);">{{v.reason}}</a>
                                                <!--<div role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" ng-hide="!manualreasonSummaryPopup" style="display:none;">
                                                    <div class="slds-modal__container" style="z-index: 1">
                                                        <header class="slds-modal__header">
                                                            <h2 class="slds-text-heading_medium slds-hyphenate">
                                                            </h2>
                                                        </header>
                                                        <div class="slds-modal__content slds-p-around_medium slds-text-align_justify" id="modal-content-id-1" >
                                                            <table class="detailList" border="0" cellpadding="0" cellspacing="0">
                                                                <tbody>
                                                                    <tr ng-repeat="(k,v) in FilterTextEditorList">
                                                                        <td class="data2Col first last " colspan="2" style="white-space: normal;">
                                                                            <div style="color: #000000;" ng-bind-html-unsafe="v.Content__c" class="ng-binding textEditorContent"></div>
                                                                            <br />
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <footer class="slds-modal__footer">
                                                            <div class="slds-text-align_center slds-m-top_x-small slds-m-bottom_x-small">
                                                                <button class="slds-button slds-button_outline-brand" onclick="return false;" ng-click="manualreasonSummaryPopup=false;">{!$Label.TPA_OK}</button>
                                                            </div>
                                                        </footer>
                                                    </div>
                                                    <div class="slds-backdrop slds-backdrop_open" style="z-index: 0"></div>
                                                </div>-->
                                                <!--<c:VFC_TPA_LightningHelpText cHlpTxt="{!Message}"/>-->
                                            </td>
                                            
                                            <td class="dataCell" ng-class="{'sortingHighlighter':columnSortBy=='offering','':columnSortBy!='offering'}">
                                                {{v.additionalTermName}}
                                            </td>
                                            <td class="dataCell" ng-class="{'sortingHighlighter':columnSortBy=='useCategory','':columnSortBy!='useCategory'}">
                                                {{v.additionalTermCategory}}
                                            </td>
                                            <td class="dataCell" ng-class="{'sortingHighlighter':columnSortBy=='use','':columnSortBy!='use'}">
                                                {{v.additionalTerm}}
                                            </td>
                                            <td class="dataCell" >
                                                <span ng-if="v.attachment == null || v.attachment == ''">N/A</span><span ng-if="v.attachment != null && v.attachment != ''"><a href="/servlet/servlet.FileDownload?file={{v.attachment}}" target="_blank">Click to View</a></span>  
                                            </td>
                                            <td class="dataCell">
                                                <div id="opPanel" class="slds-form-element__control">
                                                    <select class="slds-select" id="ddRegion" ng-model="v.action" ng-init="v.action" ng-options="v.lblVal as v.lbl for v in tpProAddTermAction" >
                                                    </select>
                                                            
                                                    <div class="requiredInput">
                                                        <div class="requiredBlock"></div>
                                                        <input class="slds-input"  type="text area" maxlength="1000" id="reqNo" placeholder="{!$Label.TPA_Comment_For_What_Is_Under_Validation}" 
                                                            ng-show="showInputboxForUnderValidation(v.action) || (v.actionvalue4 != '' && v.action == 'Under Validation' && (viewMode.indexOf('TPSubmit') != -1 || viewMode=='CSubmit'))" ng-model = "v.actionvalue4" 
                                                            ng-class="{'errStyle':v.isUnderValidationTextError,'':!v.isUnderValidationTextError}"/>
                                                    </div>
                                                </div>                            
                                            </td>
                                            <td class="dataCell">
                                                <span> {{v.reviewdate}} </span>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                               
                            </div>
                            <div ng-show="viewMode.indexOf('CSubmit') != -1 || viewMode.indexOf('MGMT') != -1 || viewMode == 'LGL' || viewMode == 'AMAAdmin'" class="slds-section slds-is-open">
                                <div class="slds-form-element slds-form-element_horizontal" style="display : flex;">
                                    <div style="flex :1; flex-basis: 50%;">
                                        <label ><b><span style="color: #0000FF;">Step 3 – Please provide your Name below and click the 'Submit' button.  </span></b></label>
                                    <!--<label ><b><span >{{tpaObj.requestName}} Review TPA Request Details: </span> </b></label>-->
                                    </div>
                                    <div style= "flex: 1; flex-basis: 65%; font-weight: 500;">
                                        <label>
                                            <a href="{!permittedUseDefSummary}" style ="text-decoration: underline;" target="_blank" >Click Here to Review Permitted Use Definitions</a>
                                            <span>
                                                for associated Authorized / Non-Authorized Activities
                                            </span>
                                        </label>
                                    </div>
                                </div>
                                <div aria-hidden="false" class="slds-section__content">
                                    <table class="list slds-table slds-table_bordered slds-table_col-bordered">
                                        
                                        <tr class="dataRow" onfocus="if (window.hiOn){hiOn(this);}" onblur="if (window.hiOff){hiOff(this);}" onmouseout="if (window.hiOff){hiOff(this);} " onmouseover="if (window.hiOn){hiOn(this);} ">
                                            <td class="dataCell">
                                                {{nameLabel}}
                                            </td>
                                            <td class="dataCell">
                                                <div id="opPanel" class="slds-form-element__control">
                                                        <div class="requiredInput">
                                                            <div class="requiredBlock"></div>
                                                            <input class="slds-input" type="text" id="reqNo" placeholder="{{nameLabel}}" 
                                                                 ng-model = "commercialOwnerName" ng-disabled = "oldCommercialOwnerName != '' && isSubmitButtonEnabled"
                                                                ng-class="{'errStyle':isCommercialOwnerNameError,'':!isCommercialOwnerNameError}"/>
                                                        </div>
                                                    </div>
                                            </td>
                                        </tr>
                                        <tr class="dataRow" onfocus="if (window.hiOn){hiOn(this);}" onblur="if (window.hiOff){hiOff(this);}" onmouseout="if (window.hiOff){hiOff(this);} " onmouseover="if (window.hiOn){hiOn(this);} ">
                                            <td class="dataCell">
                                                {!$Label.TPA_Date_of_Review}
                                            </td>
                                            <td class="dataCell">
                                                <div id="opPanel" class="slds-form-element__control">
                                                        <div class="requiredInput">
                                                            <div class="requiredBlock"></div>
                                                            <input class="slds-input" type="text" id="reqNo" placeholder="{!$Label.TPA_Date_of_Review}" 
                                                                ng-model = "dateOfReview" ng-disabled = "dateOfReview != ''"
                                                                ng-class="{'errStyle':isCommercialReasonActionTakenError,'':!isCommercialReasonActionTakenError}"/>
                                                        </div>
                                                    </div>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div>
                            <div class="slds-float_right" style="width: 100%; text-align: right;">
                                <button  class="slds-button slds-button_brand" onclick="return false;" ng-click="submitForm();" ng-disabled = "isSubmitButtonEnabled">
                                    {!$Label.TPA_Submit}
                                </button>
                                <button class="slds-button slds-button_brand" onclick="return false;" ng-disabled = "isSubmitButtonEnabled" 
                                        ng-click="onActionClick();closeTabOnCancel('VFP_TPA_Page_Status?type=venOfferingReturnCancelled');">
                                    {!$Label.TPA_Cancel}
                                </button>
                            </div>
                            <span class="slds-float_left" ng-show="!isTPProcessorLogin">
                                <label ><b><span style="color: #00b0f0">Planned Leave of Absence? Submit your Temporary Change in Coverage <a ng-href="{!ComOwnnerChangeFormLink}" style ="text-decoration: underline; color: #00b0f0">Here.       </a></span></b></label>
                            </span>
                           </div>
                        </div>
                       
                    </div>
                </apex:form>
            </body>
        </html>
    </apex:outputPanel><!-- Added for site to community logic submission-->
</apex:page>

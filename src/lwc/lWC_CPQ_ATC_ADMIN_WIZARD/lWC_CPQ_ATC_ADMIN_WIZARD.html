<template>
    <lightning-layout>
        <lightning-layout-item size="6">
            <lightning-card title="Upload Market Share Data Using Excel File" icon-name="custom:custom2">
                <div class="slds-m-left_x-large">
                    <div class="slds-p-around_medium" style="display: inline">
                        <lightning-layout>
                            <lightning-layout-item size="6">
                                <lightning-input type="file" class="uploadFile"
                                accept=".xlsx, .xls, .csv" required message-when-value-missing="Please upload a file"
                                label="Attachments" onchange={openFileUpload}></lightning-input>
                            </lightning-layout-item>
                            <lightning-layout-item size="3">
                                <lightning-combobox class="slds-size_1-of-2" style="display: inline; width: 30%"
                                    name="Quarter"
                                    label="Quarter"
                                    value=""
                                    placeholder="None"
                                    options={options}
                                    onchange={handleChange}
                                ></lightning-combobox>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <br/>
                    <template if:true={fileName}>
                        {fileName}
                    </template>
                    <lightning-button variant="brand" label="Save" title="Save" onclick={save} class="slds-m-left_x-large"></lightning-button>
                    <lightning-button variant="white" label="Cancel" title="Cancel" onclick={cancel} class="slds-m-left_x-small"></lightning-button>
                    <br>
                    <br>
                    <template if:true={showBatchInProgress}>
                        <h2>Market share % update In-Progress.....
                            <lightning-icon icon-name="utility:sync" alternative-text="In-Progress" title="In-Progress"></lightning-icon>
                        </h2>
                    </template>
                    <template if:true={showBatchSuccess}>
                        <h2>Market share % updated successfully
                            <lightning-icon icon-name="action:approval" alternative-text="Success" title="Success" size="xx-small"></lightning-icon>
                        </h2>
                    </template>
                    <template if:true={showBatchFail}>
                        <h2>Market share % update failed
                            <lightning-icon icon-name="action:close" alternative-text="Fail" title="Fail" size="xx-small"></lightning-icon>
                        </h2>
                    </template>
                </div>
            </lightning-card>
            <template if:true={loaded}>
                <lightning-spinner variant="brand" alternative-text="Loading"></lightning-spinner>
            </template>
        </lightning-layout-item>
        <lightning-layout-item size="6">
            <lightning-card  title="Export ATC/OTC Market share" icon-name="standard:contract_line_outcome" >
                <div class="slds-m-right_x-large">
                    <div class="slds-p-around_medium" >
                        <lightning-button variant="success" label="Export" title="Export" onclick={navigateToReport} class="slds-m-left_x-large"></lightning-button>
                     </div>
                </div>
            </lightning-card>
        </lightning-layout-item>
    </lightning-layout>
</template>
